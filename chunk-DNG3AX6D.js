import{a as C,b as M,d as R,g as T,h as q}from"./chunk-IYNELJD3.js";import{i as A,j as d,l as k,m as p,o as I}from"./chunk-W427QTGG.js";import{k as y,l as H}from"./chunk-BKKMM5NX.js";import{d as g}from"./chunk-SO6VPFYA.js";var w,N=g(()=>{"use strict";w=class o{static Eval(t,r){return t.match(/\([^()]*\)/g)?t=t.replace(/\([^()]*\)/g,e=>(e=e.slice(1,e.length-1),o._HandleParenthesisContent(e,r))):t=o._HandleParenthesisContent(t,r),t==="true"?!0:t==="false"?!1:o.Eval(t,r)}static _HandleParenthesisContent(t,r){r=r||(h=>h==="true");let e,s=t.split("||");for(let h in s)if(Object.prototype.hasOwnProperty.call(s,h)){let i=o._SimplifyNegation(s[h].trim()),n=i.split("&&");if(n.length>1)for(let u=0;u<n.length;++u){let a=o._SimplifyNegation(n[u].trim());if(a!=="true"&&a!=="false"?a[0]==="!"?e=!r(a.substring(1)):e=r(a):e=a==="true",!e){i="false";break}}if(e||i==="true"){e=!0;break}i!=="true"&&i!=="false"?i[0]==="!"?e=!r(i.substring(1)):e=r(i):e=i==="true"}return e?"true":"false"}static _SimplifyNegation(t){return t=t.replace(/^[\s!]+/,r=>(r=r.replace(/[\s]/g,()=>""),r.length%2?"!":"")),t=t.trim(),t==="!true"?t="false":t==="!false"&&(t="true"),t}}});var m,D=g(()=>{"use strict";N();m=class o{static EnableFor(t){t._tags=t._tags||{},t.hasTags=()=>o.HasTags(t),t.addTags=r=>o.AddTagsTo(t,r),t.removeTags=r=>o.RemoveTagsFrom(t,r),t.matchesTagsQuery=r=>o.MatchesQuery(t,r)}static DisableFor(t){delete t._tags,delete t.hasTags,delete t.addTags,delete t.removeTags,delete t.matchesTagsQuery}static HasTags(t){if(!t._tags)return!1;let r=t._tags;for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!0;return!1}static GetTags(t,r=!0){if(!t._tags)return null;if(r){let e=[];for(let s in t._tags)Object.prototype.hasOwnProperty.call(t._tags,s)&&t._tags[s]===!0&&e.push(s);return e.join(" ")}else return t._tags}static AddTagsTo(t,r){if(!r||typeof r!="string")return;r.split(" ").forEach(function(s){o._AddTagTo(t,s)})}static _AddTagTo(t,r){r=r.trim(),!(r===""||r==="true"||r==="false")&&(r.match(/[\s]/)||r.match(/^([!]|([|]|[&]){2})/)||(o.EnableFor(t),t._tags[r]=!0))}static RemoveTagsFrom(t,r){if(!o.HasTags(t))return;let e=r.split(" ");for(let s in e)o._RemoveTagFrom(t,e[s])}static _RemoveTagFrom(t,r){delete t._tags[r]}static MatchesQuery(t,r){return r===void 0?!0:r===""?o.HasTags(t):w.Eval(r,e=>o.HasTags(t)&&t._tags[e])}}});var x,E=g(()=>{"use strict";I();x=class o{constructor(t,r,e,s){this.normal=new d(t,r,e),this.d=s}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new o(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let t=this.normal.getHashCode();return t=t*397^(this.d|0),t}normalize(){let t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),r=0;return t!==0&&(r=1/t),this.normal.x*=r,this.normal.y*=r,this.normal.z*=r,this.d*=r,this}transform(t){let r=o._TmpMatrix;t.invertToRef(r);let e=r.m,s=this.normal.x,h=this.normal.y,i=this.normal.z,n=this.d,u=s*e[0]+h*e[1]+i*e[2]+n*e[3],a=s*e[4]+h*e[5]+i*e[6]+n*e[7],l=s*e[8]+h*e[9]+i*e[10]+n*e[11],c=s*e[12]+h*e[13]+i*e[14]+n*e[15];return new o(u,a,l,c)}dotCoordinate(t){return this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z+this.d}copyFromPoints(t,r,e){let s=r.x-t.x,h=r.y-t.y,i=r.z-t.z,n=e.x-t.x,u=e.y-t.y,a=e.z-t.z,l=h*a-i*u,c=i*n-s*a,P=s*u-h*n,F=Math.sqrt(l*l+c*c+P*P),f;return F!==0?f=1/F:f=0,this.normal.x=l*f,this.normal.y=c*f,this.normal.z=P*f,this.d=-(this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z),this}isFrontFacingTo(t,r){return d.Dot(this.normal,t)<=r}signedDistanceTo(t){return d.Dot(t,this.normal)+this.d}static FromArray(t){return new o(t[0],t[1],t[2],t[3])}static FromPoints(t,r,e){let s=new o(0,0,0,0);return s.copyFromPoints(t,r,e),s}static FromPositionAndNormal(t,r){let e=new o(0,0,0,0);return this.FromPositionAndNormalToRef(t,r,e)}static FromPositionAndNormalToRef(t,r,e){return e.normal.copyFrom(r),e.normal.normalize(),e.d=-t.dot(e.normal),e}static SignedDistanceToPlaneFromPositionAndNormal(t,r,e){let s=-(r.x*t.x+r.y*t.y+r.z*t.z);return d.Dot(e,r)+s}};x._TmpMatrix=p.Identity()});var z,L=g(()=>{"use strict";z=class o{constructor(t,r){this.width=t,this.height=r}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let t=this.width|0;return t=t*397^(this.height|0),t}copyFrom(t){this.width=t.width,this.height=t.height}copyFromFloats(t,r){return this.width=t,this.height=r,this}set(t,r){return this.copyFromFloats(t,r)}multiplyByFloats(t,r){return new o(this.width*t,this.height*r)}clone(){return new o(this.width,this.height)}equals(t){return t?this.width===t.width&&this.height===t.height:!1}get surface(){return this.width*this.height}static Zero(){return new o(0,0)}add(t){return new o(this.width+t.width,this.height+t.height)}subtract(t){return new o(this.width-t.width,this.height-t.height)}scale(t){return new o(this.width*t,this.height*t)}static Lerp(t,r,e){let s=t.width+(r.width-t.width)*e,h=t.height+(r.height-t.height)*e;return new o(s,h)}}});var v,G,B=g(()=>{"use strict";H();D();R();I();q();v=function(o,t,r,e={}){let s=o();m&&m.HasTags(t)&&m.AddTagsTo(s,m.GetTags(t,!0));let h=T(s),i={};for(let n in h){let u=h[n],a=t[n],l=u.type;if(a!=null&&(n!=="uniqueId"||G.AllowLoadingUniqueId))switch(l){case 0:case 6:case 9:case 11:s[n]=a;break;case 1:e.cloneTexturesOnlyOnce&&i[a.uniqueId]?s[n]=i[a.uniqueId]:(s[n]=r||a.isRenderTarget?a:a.clone(),i[a.uniqueId]=s[n]);break;case 2:case 3:case 4:case 5:case 7:case 8:case 10:case 12:s[n]=r?a:a.clone();break}}return s},G=(()=>{class o{static AppendSerializedAnimations(r,e){if(r.animations){e.animations=[];for(let s=0;s<r.animations.length;s++){let h=r.animations[s];e.animations.push(h.serialize())}}}static Serialize(r,e){e||(e={}),m&&(e.tags=m.GetTags(r));let s=T(r);for(let h in s){let i=s[h],n=i.sourceName||h,u=i.type,a=r[h];if(a!=null&&(h!=="uniqueId"||o.AllowLoadingUniqueId))switch(u){case 0:e[n]=a;break;case 1:e[n]=a.serialize();break;case 2:e[n]=a.asArray();break;case 3:e[n]=a.serialize();break;case 4:e[n]=a.asArray();break;case 5:e[n]=a.asArray();break;case 6:e[n]=a.id;break;case 7:e[n]=a.serialize();break;case 8:e[n]=a.asArray();break;case 9:e[n]=a.serialize();break;case 10:e[n]=a.asArray();break;case 11:e[n]=a.id;break;case 12:e[n]=a.asArray();break}}return e}static ParseProperties(r,e,s,h){h||(h="");let i=T(e);for(let n in i){let u=i[n],a=r[u.sourceName||n],l=u.type;if(a!=null&&(n!=="uniqueId"||o.AllowLoadingUniqueId)){let c=e;switch(l){case 0:c[n]=a;break;case 1:s&&(c[n]=o._TextureParser(a,s,h));break;case 2:c[n]=C.FromArray(a);break;case 3:c[n]=o._FresnelParametersParser(a);break;case 4:c[n]=A.FromArray(a);break;case 5:c[n]=d.FromArray(a);break;case 6:s&&(c[n]=s.getLastMeshById(a));break;case 7:c[n]=o._ColorCurvesParser(a);break;case 8:c[n]=M.FromArray(a);break;case 9:c[n]=o._ImageProcessingConfigurationParser(a);break;case 10:c[n]=k.FromArray(a);break;case 11:s&&(c[n]=s.getCameraById(a));break;case 12:c[n]=p.FromArray(a);break}}}}static Parse(r,e,s,h=null){let i=r();return m&&m.AddTagsTo(i,e.tags),o.ParseProperties(e,i,s,h),i}static Clone(r,e,s={}){return v(r,e,!1,s)}static Instanciate(r,e){return v(r,e,!0)}}return o.AllowLoadingUniqueId=!1,o._ImageProcessingConfigurationParser=t=>{throw y("ImageProcessingConfiguration")},o._FresnelParametersParser=t=>{throw y("FresnelParameters")},o._ColorCurvesParser=t=>{throw y("ColorCurves")},o._TextureParser=(t,r,e)=>{throw y("Texture")},o})()});export{x as a,E as b,z as c,L as d,w as e,N as f,m as g,D as h,G as i,B as j};
