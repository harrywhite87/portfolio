import{U as V,V as Re,Y as J,_ as be,m as $,qa as Q,r as ge,ra as Ue,s as z,w as ye}from"./chunk-BKKMM5NX.js";import{a as B,b as P}from"./chunk-BE7GIU5G.js";import{b as K,d as Le}from"./chunk-QY4EALXS.js";import{c as _,d as xe,e as k,f as me}from"./chunk-GDJFI7EY.js";import{a as G,d as L}from"./chunk-SO6VPFYA.js";function Ce(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let r=Math.random()*16|0;return(e==="x"?r:r&3|8).toString(16)})}var Me,ve=L(()=>{"use strict";Me={RandomId:Ce}});function Be(){return typeof _native<"u"&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest}var R,Y=L(()=>{"use strict";R=class e{constructor(){this._xhr=Be(),this._requestURL=""}static get IsCustomRequestAvailable(){return Object.keys(e.CustomRequestHeaders).length>0||e.CustomRequestModifiers.length>0}get requestURL(){return this._requestURL}_injectCustomRequestHeaders(){if(!this._shouldSkipRequestModifications(this._requestURL))for(let r in e.CustomRequestHeaders){let t=e.CustomRequestHeaders[r];t&&this._xhr.setRequestHeader(r,t)}}_shouldSkipRequestModifications(r){return e.SkipRequestModificationForBabylonCDN&&(r.includes("preview.babylonjs.com")||r.includes("cdn.babylonjs.com"))}get onprogress(){return this._xhr.onprogress}set onprogress(r){this._xhr.onprogress=r}get readyState(){return this._xhr.readyState}get status(){return this._xhr.status}get statusText(){return this._xhr.statusText}get response(){return this._xhr.response}get responseURL(){return this._xhr.responseURL}get responseText(){return this._xhr.responseText}get responseType(){return this._xhr.responseType}set responseType(r){this._xhr.responseType=r}get timeout(){return this._xhr.timeout}set timeout(r){this._xhr.timeout=r}addEventListener(r,t,i){this._xhr.addEventListener(r,t,i)}removeEventListener(r,t,i){this._xhr.removeEventListener(r,t,i)}abort(){this._xhr.abort()}send(r){e.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(r)}open(r,t){for(let i of e.CustomRequestModifiers){if(this._shouldSkipRequestModifications(t))return;t=i(this._xhr,t)||t}t=t.replace("file:http:","http:"),t=t.replace("file:https:","https:"),this._requestURL=t,this._xhr.open(r,t,!0)}setRequestHeader(r,t){this._xhr.setRequestHeader(r,t)}getResponseHeader(r){return this._xhr.getResponseHeader(r)}};R.CustomRequestHeaders={};R.CustomRequestModifiers=new Array;R.SkipRequestModificationForBabylonCDN=!0});var E,Z=L(()=>{"use strict";E=(()=>{class e{}return e.FilesToLoad={},e})()});var T,ee=L(()=>{"use strict";T=class{static ExponentialBackoff(r=3,t=500){return(i,l,o)=>l.status!==0||o>=r||i.indexOf("file:")!==-1?-1:Math.pow(2,o)*t}}});var g,H,C,te,re=L(()=>{"use strict";g=class extends Error{};g._setPrototypeOf=Object.setPrototypeOf||((e,r)=>(e.__proto__=r,e));H={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002},C=class e extends g{constructor(r,t,i){super(r),this.errorCode=t,this.innerError=i,this.name="RuntimeError",g._setPrototypeOf(this,e.prototype)}},te=class e extends g{constructor(r="Operation aborted"){super(r),this.name="AbortError",g._setPrototypeOf(this,e.prototype)}}});var Ee,qe,we,A,D,N,Oe,Xe,se=L(()=>{"use strict";Ee=(e,r)=>e.endsWith(r),qe=(e,r)=>e?e.startsWith(r):!1,we=e=>{if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let r="";for(let t=0;t<e.byteLength;t++)r+=String.fromCharCode(e[t]);return r},A=e=>{let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="",i,l,o,u,c,d,p,n=0,s=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);for(;n<s.length;)i=s[n++],l=n<s.length?s[n++]:Number.NaN,o=n<s.length?s[n++]:Number.NaN,u=i>>2,c=(i&3)<<4|l>>4,d=(l&15)<<2|o>>6,p=o&63,isNaN(l)?d=p=64:isNaN(o)&&(p=64),t+=r.charAt(u)+r.charAt(c)+r.charAt(d)+r.charAt(p);return t},D=e=>atob(e),N=e=>{let r=D(e),t=r.length,i=new Uint8Array(new ArrayBuffer(t));for(let l=0;l<t;l++)i[l]=r.charCodeAt(l);return i.buffer},Oe=(e,r)=>{let t=String(e);for(;t.length<r;)t="0"+t;return t},Xe={EndsWith:Ee,StartsWith:qe,Decode:we,EncodeArrayBufferToBase64:A,DecodeBase64ToString:D,DecodeBase64ToBinary:N,PadNumber:Oe}});function ue(e){return N(e.split(",")[1])}var oe,I,F,W,Se,x,ie,ne,ae,X,w,ce,le,_e,Te,de,He,q,De,Ie=L(()=>{"use strict";Y();ge();xe();Z();ee();re();se();Re();me();P();be();ye();Ue();oe=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i),I=class e extends C{constructor(r,t){super(r,H.LoadFileError),this.name="LoadFileError",g._setPrototypeOf(this,e.prototype),t instanceof R?this.request=t:this.file=t}},F=class e extends C{constructor(r,t){super(r,H.RequestFileError),this.request=t,this.name="RequestFileError",g._setPrototypeOf(this,e.prototype)}},W=class e extends C{constructor(r,t){super(r,H.ReadFileError),this.file=t,this.name="ReadFileError",g._setPrototypeOf(this,e.prototype)}},Se=e=>(e=e.replace(/#/gm,"%23"),e),x={DefaultRetryStrategy:T.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:e=>e,ScriptBaseUrl:"",ScriptPreprocessUrl:e=>e,CleanUrl:Se},ie=(e,r)=>{if(!(e&&e.indexOf("data:")===0)&&x.CorsBehavior)if(typeof x.CorsBehavior=="string"||x.CorsBehavior instanceof String)r.crossOrigin=x.CorsBehavior;else{let t=x.CorsBehavior(e);t&&(r.crossOrigin=t)}},ne={getRequiredSize:null},ae=(e,r,t,i,l="",o)=>{let u=k.LastCreatedEngine;if(typeof HTMLImageElement>"u"&&!u?._features.forceBitmapOverHTMLImageElement)return t("LoadImage is only supported in web or BabylonNative environments."),null;let c,d=!1;e instanceof ArrayBuffer||ArrayBuffer.isView(e)?typeof Blob<"u"&&typeof URL<"u"?(c=URL.createObjectURL(new Blob([e],{type:l})),d=!0):c=`data:${l};base64,`+A(e):e instanceof Blob?(c=URL.createObjectURL(e),d=!0):(c=x.CleanUrl(e),c=x.PreprocessUrl(c));let p=a=>{if(t){let f=c||e.toString();t(`Error while trying to load image: ${f.indexOf("http")===0||f.length<=128?f:f.slice(0,128)+"..."}`,a)}};if(u?._features.forceBitmapOverHTMLImageElement)return w(c,a=>{u.createImageBitmap(new Blob([a],{type:l}),G({premultiplyAlpha:"none"},o)).then(f=>{r(f),d&&URL.revokeObjectURL(c)}).catch(f=>{t&&t("Error while trying to load image: "+e,f)})},void 0,i||void 0,!0,(a,f)=>{p(f)}),null;let n=new Image;if(ne.getRequiredSize){let a=ne.getRequiredSize(e);a.width&&(n.width=a.width),a.height&&(n.height=a.height)}ie(c,n);let s=[],m=()=>{s.forEach(a=>{a.target.addEventListener(a.name,a.handler)})},h=()=>{s.forEach(a=>{a.target.removeEventListener(a.name,a.handler)}),s.length=0},O=()=>{h(),r(n),d&&n.src&&URL.revokeObjectURL(n.src)},b=a=>{h(),p(a),d&&n.src&&URL.revokeObjectURL(n.src)},S=a=>{if(a.blockedURI!==n.src||a.disposition==="report")return;h();let f=new Error(`CSP violation of policy ${a.effectiveDirective} ${a.blockedURI}. Current policy is ${a.originalPolicy}`);k.UseFallbackTexture=!1,p(f),d&&n.src&&URL.revokeObjectURL(n.src),n.src=""};s.push({target:n,name:"load",handler:O}),s.push({target:n,name:"error",handler:b}),s.push({target:document,name:"securitypolicyviolation",handler:S}),m();let v=c.substring(0,5)==="blob:",U=c.substring(0,5)==="data:",y=()=>{v||U||!R.IsCustomRequestAvailable?n.src=c:w(c,(a,f,j)=>{let fe=!l&&j?j:l,pe=new Blob([a],{type:fe}),he=URL.createObjectURL(pe);d=!0,n.src=he},void 0,i||void 0,!0,(a,f)=>{p(f)})},M=()=>{i&&i.loadImage(c,n)};if(!v&&!U&&i&&i.enableTexturesOffline)i.open(M,y);else{if(c.indexOf("file:")!==-1){let a=decodeURIComponent(c.substring(5).toLowerCase());if(E.FilesToLoad[a]&&typeof URL<"u"){try{let f;try{f=URL.createObjectURL(E.FilesToLoad[a])}catch{f=URL.createObjectURL(E.FilesToLoad[a])}n.src=f,d=!0}catch{n.src=""}return n}}y()}return n},X=(e,r,t,i,l)=>{let o=new FileReader,u={onCompleteObservable:new _,abort:()=>o.abort()};return o.onloadend=()=>u.onCompleteObservable.notifyObservers(u),l&&(o.onerror=()=>{l(new W(`Unable to read ${e.name}`,e))}),o.onload=c=>{r(c.target.result)},t&&(o.onprogress=t),i?o.readAsArrayBuffer(e):o.readAsText(e),u},w=(e,r,t,i,l,o,u)=>{if(e.name)return X(e,r,t,l,o?n=>{o(void 0,n)}:void 0);let c=e;if(c.indexOf("file:")!==-1){let n=decodeURIComponent(c.substring(5).toLowerCase());n.indexOf("./")===0&&(n=n.substring(2));let s=E.FilesToLoad[n];if(s)return X(s,r,t,l,o?m=>o(void 0,new I(m.message,m.file)):void 0)}let{match:d,type:p}=Te(c);if(d){let n={onCompleteObservable:new _,abort:()=>()=>{}};try{let s=l?ue(c):de(c);r(s,void 0,p)}catch(s){o?o(void 0,s):B.Error(s.message||"Failed to parse the Data URL")}return J.SetImmediate(()=>{n.onCompleteObservable.notifyObservers(n)}),n}return ce(c,(n,s)=>{r(n,s?.responseURL,s?.getResponseHeader("content-type"))},t,i,l,o?n=>{o(n.request,new I(n.message,n.request))}:void 0,u)},ce=(e,r,t,i,l,o,u)=>{e=x.CleanUrl(e),e=x.PreprocessUrl(e);let c=x.BaseUrl+e,d=!1,p={onCompleteObservable:new _,abort:()=>d=!0},n=()=>{let s=new R,m=null,h,O=()=>{s&&(t&&s.removeEventListener("progress",t),h&&s.removeEventListener("readystatechange",h),s.removeEventListener("loadend",b))},b=()=>{O(),p.onCompleteObservable.notifyObservers(p),p.onCompleteObservable.clear(),t=void 0,h=null,b=null,o=void 0,u=void 0,r=void 0};p.abort=()=>{d=!0,b&&b(),s&&s.readyState!==(XMLHttpRequest.DONE||4)&&s.abort(),m!==null&&(clearTimeout(m),m=null),s=null};let S=U=>{let y=U.message||"Unknown error";o&&s?o(new F(y,s)):B.Error(y)},v=U=>{if(s){if(s.open("GET",c),u)try{u(s)}catch(y){S(y);return}l&&(s.responseType="arraybuffer"),t&&s.addEventListener("progress",t),b&&s.addEventListener("loadend",b),h=()=>{if(!(d||!s)&&s.readyState===(XMLHttpRequest.DONE||4)){if(h&&s.removeEventListener("readystatechange",h),s.status>=200&&s.status<300||s.status===0&&(!$()||le())){let a=l?s.response:s.responseText;if(a!==null){try{r&&r(a,s)}catch(f){S(f)}return}}let y=x.DefaultRetryStrategy;if(y){let a=y(c,s,U);if(a!==-1){O(),s=new R,m=setTimeout(()=>v(U+1),a);return}}let M=new F("Error status: "+s.status+" "+s.statusText+" - Unable to load "+c,s);o&&o(M)}},s.addEventListener("readystatechange",h),s.send()}};v(0)};if(i&&i.enableSceneOffline){let s=h=>{h&&h.status>400?o&&o(h):n()},m=()=>{i&&i.loadFile(x.BaseUrl+e,h=>{!d&&r&&r(h),p.onCompleteObservable.notifyObservers(p)},t?h=>{!d&&t&&t(h)}:void 0,s,l)};i.open(m,s)}else n();return p},le=()=>typeof location<"u"&&location.protocol==="file:",_e=e=>oe.test(e),Te=e=>{let r=oe.exec(e);return r===null||r.length===0?{match:!1,type:""}:{match:!0,type:r[0].replace("data:","").replace("base64,","")}};de=e=>D(e.split(",")[1]),He=()=>{Q._FileToolsLoadImage=ae,z.loadFile=w,V.loadFile=w};He();De=(e,r,t,i,l,o,u,c,d,p)=>{q={DecodeBase64UrlToBinary:e,DecodeBase64UrlToString:r,DefaultRetryStrategy:t.DefaultRetryStrategy,BaseUrl:t.BaseUrl,CorsBehavior:t.CorsBehavior,PreprocessUrl:t.PreprocessUrl,IsBase64DataUrl:i,IsFileURL:l,LoadFile:o,LoadImage:u,ReadFile:c,RequestFile:d,SetCorsBehavior:p},Object.defineProperty(q,"DefaultRetryStrategy",{get:function(){return t.DefaultRetryStrategy},set:function(n){t.DefaultRetryStrategy=n}}),Object.defineProperty(q,"BaseUrl",{get:function(){return t.BaseUrl},set:function(n){t.BaseUrl=n}}),Object.defineProperty(q,"PreprocessUrl",{get:function(){return t.PreprocessUrl},set:function(n){t.PreprocessUrl=n}}),Object.defineProperty(q,"CorsBehavior",{get:function(){return t.CorsBehavior},set:function(n){t.CorsBehavior=n}})};De(ue,de,x,_e,le,w,ae,X,ce,ie)});var ct,Fe=L(()=>{"use strict";P();Le();ct=(()=>{class e{static Instantiate(t){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[t])return this.RegisteredExternalClasses[t];let i=K(t);if(i)return i;B.Warn(t+" not found, you may have missed an import.");let l=t.split("."),o=window||this;for(let u=0,c=l.length;u<c;u++)o=o[l[u]];return typeof o!="function"?null:o}}return e.RegisteredExternalClasses={},e})()});export{Ce as a,Me as b,ve as c,R as d,Y as e,E as f,Z as g,T as h,ee as i,g as j,H as k,C as l,te as m,re as n,Ee as o,qe as p,we as q,A as r,D as s,N as t,Oe as u,Xe as v,se as w,I as x,F as y,W as z,x as A,ie as B,ne as C,ae as D,X as E,w as F,ce as G,le as H,_e as I,Te as J,ue as K,de as L,q as M,De as N,Ie as O,ct as P,Fe as Q};
