import{a as E,b as O}from"./chunk-BE7GIU5G.js";import{d}from"./chunk-SO6VPFYA.js";function D(i){let n=0;return{id_length:i[n++],colormap_type:i[n++],image_type:i[n++],colormap_index:i[n++]|i[n++]<<8,colormap_length:i[n++]|i[n++]<<8,colormap_size:i[n++],origin:[i[n++]|i[n++]<<8,i[n++]|i[n++]<<8],width:i[n++]|i[n++]<<8,height:i[n++]|i[n++]<<8,pixel_size:i[n++],flags:i[n++]}}function R(i,n){if(n.length<19){E.Error("Unable to load TGA file - Not enough data to contain header");return}let a=18,r=D(n);if(r.id_length+a>n.length){E.Error("Unable to load TGA file - Not enough data");return}a+=r.id_length;let _=!1,f=!1,x=!1;switch(r.image_type){case L:_=!0;case Y:f=!0;break;case P:_=!0;case k:break;case C:_=!0;case z:x=!0;break}let u,p=r.pixel_size>>3,l=r.width*r.height*p,s;if(f&&(s=n.subarray(a,a+=r.colormap_length*(r.colormap_size>>3))),_){u=new Uint8Array(l);let G,y,m,b=0,A=new Uint8Array(p);for(;a<l&&b<l;)if(G=n[a++],y=(G&127)+1,G&128){for(m=0;m<p;++m)A[m]=n[a++];for(m=0;m<y;++m)u.set(A,b+m*p);b+=p*y}else{for(y*=p,m=0;m<y;++m)u[b+m]=n[a++];b+=y}}else u=n.subarray(a,a+=f?r.width*r.height:l);let g,c,o,t,e,h;switch((r.flags&B)>>H){default:case X:g=0,o=1,h=r.width,c=0,t=1,e=r.height;break;case M:g=0,o=1,h=r.width,c=r.height-1,t=-1,e=-1;break;case v:g=r.width-1,o=-1,h=-1,c=0,t=1,e=r.height;break;case S:g=r.width-1,o=-1,h=-1,c=r.height-1,t=-1,e=-1;break}let w="_getImageData"+(x?"Grey":"")+r.pixel_size+"bits",I=V[w](r,s,u,c,t,e,g,o,h);i.getEngine()._uploadDataToTextureDirectly(i,I)}function F(i,n,a,r,_,f,x,u,p){let l=a,s=n,g=i.width,c=i.height,o,t=0,e,h,w=new Uint8Array(g*c*4);for(h=r;h!==f;h+=_)for(e=x;e!==p;e+=u,t++)o=l[t],w[(e+g*h)*4+3]=255,w[(e+g*h)*4+2]=s[o*3+0],w[(e+g*h)*4+1]=s[o*3+1],w[(e+g*h)*4+0]=s[o*3+2];return w}function K(i,n,a,r,_,f,x,u,p){let l=a,s=i.width,g=i.height,c,o=0,t,e,h=new Uint8Array(s*g*4);for(e=r;e!==f;e+=_)for(t=x;t!==p;t+=u,o+=2){c=l[o+0]+(l[o+1]<<8);let w=((c&31744)>>10)*255/31|0,I=((c&992)>>5)*255/31|0,U=(c&31)*255/31|0;h[(t+s*e)*4+0]=w,h[(t+s*e)*4+1]=I,h[(t+s*e)*4+2]=U,h[(t+s*e)*4+3]=c&32768?0:255}return h}function j(i,n,a,r,_,f,x,u,p){let l=a,s=i.width,g=i.height,c=0,o,t,e=new Uint8Array(s*g*4);for(t=r;t!==f;t+=_)for(o=x;o!==p;o+=u,c+=3)e[(o+s*t)*4+3]=255,e[(o+s*t)*4+2]=l[c+0],e[(o+s*t)*4+1]=l[c+1],e[(o+s*t)*4+0]=l[c+2];return e}function q(i,n,a,r,_,f,x,u,p){let l=a,s=i.width,g=i.height,c=0,o,t,e=new Uint8Array(s*g*4);for(t=r;t!==f;t+=_)for(o=x;o!==p;o+=u,c+=4)e[(o+s*t)*4+2]=l[c+0],e[(o+s*t)*4+1]=l[c+1],e[(o+s*t)*4+0]=l[c+2],e[(o+s*t)*4+3]=l[c+3];return e}function J(i,n,a,r,_,f,x,u,p){let l=a,s=i.width,g=i.height,c,o=0,t,e,h=new Uint8Array(s*g*4);for(e=r;e!==f;e+=_)for(t=x;t!==p;t+=u,o++)c=l[o],h[(t+s*e)*4+0]=c,h[(t+s*e)*4+1]=c,h[(t+s*e)*4+2]=c,h[(t+s*e)*4+3]=255;return h}function Q(i,n,a,r,_,f,x,u,p){let l=a,s=i.width,g=i.height,c=0,o,t,e=new Uint8Array(s*g*4);for(t=r;t!==f;t+=_)for(o=x;o!==p;o+=u,c+=2)e[(o+s*t)*4+0]=l[c+0],e[(o+s*t)*4+1]=l[c+0],e[(o+s*t)*4+2]=l[c+0],e[(o+s*t)*4+3]=l[c+1];return e}var Y,k,z,L,P,C,B,H,M,S,X,v,V,T=d(()=>{"use strict";O();Y=1,k=2,z=3,L=9,P=10,C=11,B=48,H=4,M=0,S=1,X=2,v=3;V={GetTGAHeader:D,UploadContent:R,_getImageData8bits:F,_getImageData16bits:K,_getImageData24bits:j,_getImageData32bits:q,_getImageDataGrey8bits:J,_getImageDataGrey16bits:Q}});var N,W=d(()=>{T();N=class{constructor(){this.supportCascades=!1}loadCubeData(){throw".env not supported in Cube."}loadData(n,a,r){let _=new Uint8Array(n.buffer,n.byteOffset,n.byteLength),f=D(_);r(f.width,f.height,a.generateMipMaps,!1,()=>{R(a,_)})}}});export{D as a,R as b,V as c,T as d,N as e,W as f};
