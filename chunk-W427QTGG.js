import{a as it,d as Pt}from"./chunk-QY4EALXS.js";import{e as nt,f as pt,g as K,h as Mt}from"./chunk-GDJFI7EY.js";import{a as g,b as p,c as at,e as L,f as ct,k as It}from"./chunk-HKRXH733.js";import{d as st}from"./chunk-SO6VPFYA.js";var Lt,kt,Ot,b,ht=st(()=>{"use strict";Lt=.45454545454545453,kt=2.2,Ot=(1+Math.sqrt(5))/2,b=.001});function At(e,t){let i=[];for(let s=0;s<e;++s)i.push(t());return i}function G(e,t){return At(e,t)}function Dt(e,t,i){let s=e[t];if(typeof s!="function")return null;let n=function(){let o=e.length,r=n.previous.apply(e,arguments);return i(t,o),r};return s.next=n,n.previous=s,e[t]=n,()=>{let o=n.previous;if(!o)return;let r=n.next;r?(o.next=r,r.previous=o):(o.next=void 0,e[t]=o),n.next=void 0,n.previous=void 0}}function Ht(e,t){let i=gt.map(s=>Dt(e,s,t));return()=>{i.forEach(s=>{s?.()})}}var gt,_t=st(()=>{"use strict";gt=["push","splice","pop","shift","unshift"]});var H,X,d,Q,S,O,m,U,v,Ct=st(()=>{"use strict";ht();_t();Pt();Mt();pt();It();H=e=>parseInt(e.toString().replace(/\W/g,"")),X=class e{constructor(t=0,i=0){this.x=t,this.y=i}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let t=H(this.x),i=H(this.y),s=t;return s=s*397^i,s}toArray(t,i=0){return t[i]=this.x,t[i+1]=this.y,this}fromArray(t,i=0){return e.FromArrayToRef(t,i,this),this}asArray(){return[this.x,this.y]}copyFrom(t){return this.x=t.x,this.y=t.y,this}copyFromFloats(t,i){return this.x=t,this.y=i,this}set(t,i){return this.copyFromFloats(t,i)}setAll(t){return this.copyFromFloats(t,t)}add(t){return new e(this.x+t.x,this.y+t.y)}addToRef(t,i){return i.x=this.x+t.x,i.y=this.y+t.y,i}addInPlace(t){return this.x+=t.x,this.y+=t.y,this}addInPlaceFromFloats(t,i){return this.x+=t,this.y+=i,this}addVector3(t){return new e(this.x+t.x,this.y+t.y)}subtract(t){return new e(this.x-t.x,this.y-t.y)}subtractToRef(t,i){return i.x=this.x-t.x,i.y=this.y-t.y,i}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this}multiply(t){return new e(this.x*t.x,this.y*t.y)}multiplyToRef(t,i){return i.x=this.x*t.x,i.y=this.y*t.y,i}multiplyByFloats(t,i){return new e(this.x*t,this.y*i)}divide(t){return new e(this.x/t.x,this.y/t.y)}divideToRef(t,i){return i.x=this.x/t.x,i.y=this.y/t.y,i}divideInPlace(t){return this.x=this.x/t.x,this.y=this.y/t.y,this}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t.x,t.y)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t.x,t.y)}minimizeInPlaceFromFloats(t,i){return this.x=Math.min(t,this.x),this.y=Math.min(i,this.y),this}maximizeInPlaceFromFloats(t,i){return this.x=Math.max(t,this.x),this.y=Math.max(i,this.y),this}subtractFromFloats(t,i){return new e(this.x-t,this.y-i)}subtractFromFloatsToRef(t,i,s){return s.x=this.x-t,s.y=this.y-i,s}negate(){return new e(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(t){return t.x=-this.x,t.y=-this.y,t}scaleInPlace(t){return this.x*=t,this.y*=t,this}scale(t){return new e(this.x*t,this.y*t)}scaleToRef(t,i){return i.x=this.x*t,i.y=this.y*t,i}scaleAndAddToRef(t,i){return i.x+=this.x*t,i.y+=this.y*t,i}equals(t){return t&&this.x===t.x&&this.y===t.y}equalsWithEpsilon(t,i=b){return t&&g(this.x,t.x,i)&&g(this.y,t.y,i)}equalsToFloats(t,i){return this.x===t&&this.y===i}floor(){return new e(Math.floor(this.x),Math.floor(this.y))}floorToRef(t){return t.x=Math.floor(this.x),t.y=Math.floor(this.y),t}fract(){return new e(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}fractToRef(t){return t.x=this.x-Math.floor(this.x),t.y=this.y-Math.floor(this.y),t}rotateToRef(t,i){let s=Math.cos(t),n=Math.sin(t),o=s*this.x-n*this.y,r=n*this.x+s*this.y;return i.x=o,i.y=r,i}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(t){return t===0||t===1?this:this.scaleInPlace(1/t)}normalizeToNew(){let t=new e;return this.normalizeToRef(t),t}normalizeToRef(t){let i=this.length();return i===0&&(t.x=this.x,t.y=this.y),this.scaleToRef(1/i,t)}clone(){return new e(this.x,this.y)}dot(t){return this.x*t.x+this.y*t.y}static Zero(){return new e(0,0)}static One(){return new e(1,1)}static Random(t=0,i=1){return new e(p(t,i),p(t,i))}static RandomToRef(t=0,i=1,s){return s.copyFromFloats(p(t,i),p(t,i))}static get ZeroReadOnly(){return e._ZeroReadOnly}static FromArray(t,i=0){return new e(t[i],t[i+1])}static FromArrayToRef(t,i,s){return s.x=t[i],s.y=t[i+1],s}static FromFloatsToRef(t,i,s){return s.copyFromFloats(t,i),s}static CatmullRom(t,i,s,n,o){let r=o*o,a=o*r,c=.5*(2*i.x+(-t.x+s.x)*o+(2*t.x-5*i.x+4*s.x-n.x)*r+(-t.x+3*i.x-3*s.x+n.x)*a),h=.5*(2*i.y+(-t.y+s.y)*o+(2*t.y-5*i.y+4*s.y-n.y)*r+(-t.y+3*i.y-3*s.y+n.y)*a);return new e(c,h)}static ClampToRef(t,i,s,n){return n.x=L(t.x,i.x,s.x),n.y=L(t.y,i.y,s.y),n}static Clamp(t,i,s){let n=L(t.x,i.x,s.x),o=L(t.y,i.y,s.y);return new e(n,o)}static Hermite(t,i,s,n,o){let r=o*o,a=o*r,c=2*a-3*r+1,h=-2*a+3*r,_=a-2*r+o,y=a-r,x=t.x*c+s.x*h+i.x*_+n.x*y,z=t.y*c+s.y*h+i.y*_+n.y*y;return new e(x,z)}static Hermite1stDerivative(t,i,s,n,o){return this.Hermite1stDerivativeToRef(t,i,s,n,o,new e)}static Hermite1stDerivativeToRef(t,i,s,n,o,r){let a=o*o;return r.x=(a-o)*6*t.x+(3*a-4*o+1)*i.x+(-a+o)*6*s.x+(3*a-2*o)*n.x,r.y=(a-o)*6*t.y+(3*a-4*o+1)*i.y+(-a+o)*6*s.y+(3*a-2*o)*n.y,r}static Lerp(t,i,s){return e.LerpToRef(t,i,s,new e)}static LerpToRef(t,i,s,n){return n.x=t.x+(i.x-t.x)*s,n.y=t.y+(i.y-t.y)*s,n}static Dot(t,i){return t.x*i.x+t.y*i.y}static Normalize(t){return e.NormalizeToRef(t,new e)}static NormalizeToRef(t,i){return t.normalizeToRef(i),i}static Minimize(t,i){let s=t.x<i.x?t.x:i.x,n=t.y<i.y?t.y:i.y;return new e(s,n)}static Maximize(t,i){let s=t.x>i.x?t.x:i.x,n=t.y>i.y?t.y:i.y;return new e(s,n)}static Transform(t,i){return e.TransformToRef(t,i,new e)}static TransformToRef(t,i,s){let n=i.m,o=t.x*n[0]+t.y*n[4]+n[12],r=t.x*n[1]+t.y*n[5]+n[13];return s.x=o,s.y=r,s}static PointInTriangle(t,i,s,n){let o=.5*(-s.y*n.x+i.y*(-s.x+n.x)+i.x*(s.y-n.y)+s.x*n.y),r=o<0?-1:1,a=(i.y*n.x-i.x*n.y+(n.y-i.y)*t.x+(i.x-n.x)*t.y)*r,c=(i.x*s.y-i.y*s.x+(i.y-s.y)*t.x+(s.x-i.x)*t.y)*r;return a>0&&c>0&&a+c<2*o*r}static Distance(t,i){return Math.sqrt(e.DistanceSquared(t,i))}static DistanceSquared(t,i){let s=t.x-i.x,n=t.y-i.y;return s*s+n*n}static Center(t,i){return e.CenterToRef(t,i,new e)}static CenterToRef(t,i,s){return s.copyFromFloats((t.x+i.x)/2,(t.y+i.y)/2)}static DistanceOfPointFromSegment(t,i,s){let n=e.DistanceSquared(i,s);if(n===0)return e.Distance(t,i);let o=s.subtract(i),r=Math.max(0,Math.min(1,e.Dot(t.subtract(i),o)/n)),a=i.add(o.multiplyByFloats(r,r));return e.Distance(t,a)}};X._V8PerformanceHack=new X(.5,.5);X._ZeroReadOnly=X.Zero();Object.defineProperties(X.prototype,{dimension:{value:[2]},rank:{value:1}});d=class e{get x(){return this._x}set x(t){this._x=t,this._isDirty=!0}get y(){return this._y}set y(t){this._y=t,this._isDirty=!0}get z(){return this._z}set z(t){this._z=t,this._isDirty=!0}constructor(t=0,i=0,s=0){this._isDirty=!0,this._x=t,this._y=i,this._z=s}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z}}`}getClassName(){return"Vector3"}getHashCode(){let t=H(this._x),i=H(this._y),s=H(this._z),n=t;return n=n*397^i,n=n*397^s,n}asArray(){return[this._x,this._y,this._z]}toArray(t,i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,this}fromArray(t,i=0){return e.FromArrayToRef(t,i,this),this}toQuaternion(){return S.RotationYawPitchRoll(this._y,this._x,this._z)}addInPlace(t){return this._x+=t._x,this._y+=t._y,this._z+=t._z,this._isDirty=!0,this}addInPlaceFromFloats(t,i,s){return this._x+=t,this._y+=i,this._z+=s,this._isDirty=!0,this}add(t){return new e(this._x+t._x,this._y+t._y,this._z+t._z)}addToRef(t,i){return i._x=this._x+t._x,i._y=this._y+t._y,i._z=this._z+t._z,i._isDirty=!0,i}subtractInPlace(t){return this._x-=t._x,this._y-=t._y,this._z-=t._z,this._isDirty=!0,this}subtract(t){return new e(this._x-t._x,this._y-t._y,this._z-t._z)}subtractToRef(t,i){return this.subtractFromFloatsToRef(t._x,t._y,t._z,i)}subtractFromFloats(t,i,s){return new e(this._x-t,this._y-i,this._z-s)}subtractFromFloatsToRef(t,i,s,n){return n._x=this._x-t,n._y=this._y-i,n._z=this._z-s,n._isDirty=!0,n}negate(){return new e(-this._x,-this._y,-this._z)}negateInPlace(){return this._x*=-1,this._y*=-1,this._z*=-1,this._isDirty=!0,this}negateToRef(t){return t._x=this._x*-1,t._y=this._y*-1,t._z=this._z*-1,t._isDirty=!0,t}scaleInPlace(t){return this._x*=t,this._y*=t,this._z*=t,this._isDirty=!0,this}scale(t){return new e(this._x*t,this._y*t,this._z*t)}scaleToRef(t,i){return i._x=this._x*t,i._y=this._y*t,i._z=this._z*t,i._isDirty=!0,i}getNormalToRef(t){let i=this.length(),s=Math.acos(this.y/i),n=Math.atan2(this.z,this.x);s>Math.PI/2?s-=Math.PI/2:s+=Math.PI/2;let o=i*Math.sin(s)*Math.cos(n),r=i*Math.cos(s),a=i*Math.sin(s)*Math.sin(n);return t.set(o,r,a),t}applyRotationQuaternionToRef(t,i){let s=this._x,n=this._y,o=this._z,r=t._x,a=t._y,c=t._z,h=t._w,_=2*(a*o-c*n),y=2*(c*s-r*o),x=2*(r*n-a*s);return i._x=s+h*_+a*x-c*y,i._y=n+h*y+c*_-r*x,i._z=o+h*x+r*y-a*_,i._isDirty=!0,i}applyRotationQuaternionInPlace(t){return this.applyRotationQuaternionToRef(t,this)}applyRotationQuaternion(t){return this.applyRotationQuaternionToRef(t,new e)}scaleAndAddToRef(t,i){return i._x+=this._x*t,i._y+=this._y*t,i._z+=this._z*t,i._isDirty=!0,i}projectOnPlane(t,i){return this.projectOnPlaneToRef(t,i,new e)}projectOnPlaneToRef(t,i,s){let n=t.normal,o=t.d,r=m.Vector3[0];this.subtractToRef(i,r),r.normalize();let a=e.Dot(r,n);if(Math.abs(a)<1e-10)s.setAll(1/0);else{let c=-(e.Dot(i,n)+o)/a,h=r.scaleInPlace(c);i.addToRef(h,s)}return s}equals(t){return t&&this._x===t._x&&this._y===t._y&&this._z===t._z}equalsWithEpsilon(t,i=b){return t&&g(this._x,t._x,i)&&g(this._y,t._y,i)&&g(this._z,t._z,i)}equalsToFloats(t,i,s){return this._x===t&&this._y===i&&this._z===s}multiplyInPlace(t){return this._x*=t._x,this._y*=t._y,this._z*=t._z,this._isDirty=!0,this}multiply(t){return this.multiplyByFloats(t._x,t._y,t._z)}multiplyToRef(t,i){return i._x=this._x*t._x,i._y=this._y*t._y,i._z=this._z*t._z,i._isDirty=!0,i}multiplyByFloats(t,i,s){return new e(this._x*t,this._y*i,this._z*s)}divide(t){return new e(this._x/t._x,this._y/t._y,this._z/t._z)}divideToRef(t,i){return i._x=this._x/t._x,i._y=this._y/t._y,i._z=this._z/t._z,i._isDirty=!0,i}divideInPlace(t){return this._x=this._x/t._x,this._y=this._y/t._y,this._z=this._z/t._z,this._isDirty=!0,this}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t._x,t._y,t._z)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t._x,t._y,t._z)}minimizeInPlaceFromFloats(t,i,s){return t<this._x&&(this.x=t),i<this._y&&(this.y=i),s<this._z&&(this.z=s),this}maximizeInPlaceFromFloats(t,i,s){return t>this._x&&(this.x=t),i>this._y&&(this.y=i),s>this._z&&(this.z=s),this}isNonUniformWithinEpsilon(t){let i=Math.abs(this._x),s=Math.abs(this._y);if(!g(i,s,t))return!0;let n=Math.abs(this._z);return!g(i,n,t)||!g(s,n,t)}get isNonUniform(){let t=Math.abs(this._x),i=Math.abs(this._y);if(t!==i)return!0;let s=Math.abs(this._z);return t!==s}floorToRef(t){return t._x=Math.floor(this._x),t._y=Math.floor(this._y),t._z=Math.floor(this._z),t._isDirty=!0,t}floor(){return new e(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fractToRef(t){return t._x=this.x-Math.floor(this._x),t._y=this.y-Math.floor(this._y),t._z=this.z-Math.floor(this._z),t._isDirty=!0,t}fract(){return new e(this.x-Math.floor(this._x),this.y-Math.floor(this._y),this.z-Math.floor(this._z))}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this._x*this._x+this._y*this._y+this._z*this._z}get hasAZeroComponent(){return this._x*this._y*this._z===0}normalize(){return this.normalizeFromLength(this.length())}reorderInPlace(t){if(t=t.toLowerCase(),t==="xyz")return this;let i=m.Vector3[0].copyFrom(this);return this.x=i[t[0]],this.y=i[t[1]],this.z=i[t[2]],this}rotateByQuaternionToRef(t,i){return t.toRotationMatrix(m.Matrix[0]),e.TransformCoordinatesToRef(this,m.Matrix[0],i),i}rotateByQuaternionAroundPointToRef(t,i,s){return this.subtractToRef(i,m.Vector3[0]),m.Vector3[0].rotateByQuaternionToRef(t,m.Vector3[0]),i.addToRef(m.Vector3[0],s),s}cross(t){return e.CrossToRef(this,t,new e)}normalizeFromLength(t){return t===0||t===1?this:this.scaleInPlace(1/t)}normalizeToNew(){return this.normalizeToRef(new e)}normalizeToRef(t){let i=this.length();return i===0||i===1?(t._x=this._x,t._y=this._y,t._z=this._z,t._isDirty=!0,t):this.scaleToRef(1/i,t)}clone(){return new e(this._x,this._y,this._z)}copyFrom(t){return this.copyFromFloats(t._x,t._y,t._z)}copyFromFloats(t,i,s){return this._x=t,this._y=i,this._z=s,this._isDirty=!0,this}set(t,i,s){return this.copyFromFloats(t,i,s)}setAll(t){return this._x=this._y=this._z=t,this._isDirty=!0,this}static GetClipFactor(t,i,s,n){let o=e.Dot(t,s),r=e.Dot(i,s);return(o-n)/(o-r)}static GetAngleBetweenVectors(t,i,s){let n=t.normalizeToRef(m.Vector3[1]),o=i.normalizeToRef(m.Vector3[2]),r=e.Dot(n,o);r=L(r,-1,1);let a=Math.acos(r),c=m.Vector3[3];return e.CrossToRef(n,o,c),e.Dot(c,s)>0?isNaN(a)?0:a:isNaN(a)?-Math.PI:-Math.acos(r)}static GetAngleBetweenVectorsOnPlane(t,i,s){m.Vector3[0].copyFrom(t);let n=m.Vector3[0];m.Vector3[1].copyFrom(i);let o=m.Vector3[1];m.Vector3[2].copyFrom(s);let r=m.Vector3[2],a=m.Vector3[3],c=m.Vector3[4];n.normalize(),o.normalize(),r.normalize(),e.CrossToRef(r,n,a),e.CrossToRef(a,r,c);let h=Math.atan2(e.Dot(o,a),e.Dot(o,c));return ct(h)}static PitchYawRollToMoveBetweenPointsToRef(t,i,s){let n=U.Vector3[0];return i.subtractToRef(t,n),s._y=Math.atan2(n.x,n.z)||0,s._x=Math.atan2(Math.sqrt(n.x**2+n.z**2),n.y)||0,s._z=0,s._isDirty=!0,s}static PitchYawRollToMoveBetweenPoints(t,i){let s=e.Zero();return e.PitchYawRollToMoveBetweenPointsToRef(t,i,s)}static SlerpToRef(t,i,s,n){s=L(s,0,1);let o=m.Vector3[0],r=m.Vector3[1];o.copyFrom(t);let a=o.length();o.normalizeFromLength(a),r.copyFrom(i);let c=r.length();r.normalizeFromLength(c);let h=e.Dot(o,r),_,y;if(h<1-b){let x=Math.acos(h),z=1/Math.sin(x);_=Math.sin((1-s)*x)*z,y=Math.sin(s*x)*z}else _=1-s,y=s;return o.scaleInPlace(_),r.scaleInPlace(y),n.copyFrom(o).addInPlace(r),n.scaleInPlace(at(a,c,s)),n}static SmoothToRef(t,i,s,n,o){return e.SlerpToRef(t,i,n===0?1:s/n,o),o}static FromArray(t,i=0){return new e(t[i],t[i+1],t[i+2])}static FromFloatArray(t,i){return e.FromArray(t,i)}static FromArrayToRef(t,i,s){return s._x=t[i],s._y=t[i+1],s._z=t[i+2],s._isDirty=!0,s}static FromFloatArrayToRef(t,i,s){return e.FromArrayToRef(t,i,s)}static FromFloatsToRef(t,i,s,n){return n.copyFromFloats(t,i,s),n}static Zero(){return new e(0,0,0)}static One(){return new e(1,1,1)}static Up(){return new e(0,1,0)}static get UpReadOnly(){return e._UpReadOnly}static get DownReadOnly(){return e._DownReadOnly}static get RightReadOnly(){return e._RightReadOnly}static get LeftReadOnly(){return e._LeftReadOnly}static get LeftHandedForwardReadOnly(){return e._LeftHandedForwardReadOnly}static get RightHandedForwardReadOnly(){return e._RightHandedForwardReadOnly}static get LeftHandedBackwardReadOnly(){return e._LeftHandedBackwardReadOnly}static get RightHandedBackwardReadOnly(){return e._RightHandedBackwardReadOnly}static get ZeroReadOnly(){return e._ZeroReadOnly}static get OneReadOnly(){return e._OneReadOnly}static Down(){return new e(0,-1,0)}static Forward(t=!1){return new e(0,0,t?-1:1)}static Backward(t=!1){return new e(0,0,t?1:-1)}static Right(){return new e(1,0,0)}static Left(){return new e(-1,0,0)}static Random(t=0,i=1){return new e(p(t,i),p(t,i),p(t,i))}static RandomToRef(t=0,i=1,s){return s.copyFromFloats(p(t,i),p(t,i),p(t,i))}static TransformCoordinates(t,i){let s=e.Zero();return e.TransformCoordinatesToRef(t,i,s),s}static TransformCoordinatesToRef(t,i,s){return e.TransformCoordinatesFromFloatsToRef(t._x,t._y,t._z,i,s),s}static TransformCoordinatesFromFloatsToRef(t,i,s,n,o){let r=n.m,a=t*r[0]+i*r[4]+s*r[8]+r[12],c=t*r[1]+i*r[5]+s*r[9]+r[13],h=t*r[2]+i*r[6]+s*r[10]+r[14],_=1/(t*r[3]+i*r[7]+s*r[11]+r[15]);return o._x=a*_,o._y=c*_,o._z=h*_,o._isDirty=!0,o}static TransformNormal(t,i){let s=e.Zero();return e.TransformNormalToRef(t,i,s),s}static TransformNormalToRef(t,i,s){return this.TransformNormalFromFloatsToRef(t._x,t._y,t._z,i,s),s}static TransformNormalFromFloatsToRef(t,i,s,n,o){let r=n.m;return o._x=t*r[0]+i*r[4]+s*r[8],o._y=t*r[1]+i*r[5]+s*r[9],o._z=t*r[2]+i*r[6]+s*r[10],o._isDirty=!0,o}static CatmullRom(t,i,s,n,o){let r=o*o,a=o*r,c=.5*(2*i._x+(-t._x+s._x)*o+(2*t._x-5*i._x+4*s._x-n._x)*r+(-t._x+3*i._x-3*s._x+n._x)*a),h=.5*(2*i._y+(-t._y+s._y)*o+(2*t._y-5*i._y+4*s._y-n._y)*r+(-t._y+3*i._y-3*s._y+n._y)*a),_=.5*(2*i._z+(-t._z+s._z)*o+(2*t._z-5*i._z+4*s._z-n._z)*r+(-t._z+3*i._z-3*s._z+n._z)*a);return new e(c,h,_)}static Clamp(t,i,s){let n=new e;return e.ClampToRef(t,i,s,n),n}static ClampToRef(t,i,s,n){let o=t._x;o=o>s._x?s._x:o,o=o<i._x?i._x:o;let r=t._y;r=r>s._y?s._y:r,r=r<i._y?i._y:r;let a=t._z;return a=a>s._z?s._z:a,a=a<i._z?i._z:a,n.copyFromFloats(o,r,a),n}static CheckExtends(t,i,s){i.minimizeInPlace(t),s.maximizeInPlace(t)}static Hermite(t,i,s,n,o){let r=o*o,a=o*r,c=2*a-3*r+1,h=-2*a+3*r,_=a-2*r+o,y=a-r,x=t._x*c+s._x*h+i._x*_+n._x*y,z=t._y*c+s._y*h+i._y*_+n._y*y,R=t._z*c+s._z*h+i._z*_+n._z*y;return new e(x,z,R)}static Hermite1stDerivative(t,i,s,n,o){let r=new e;return this.Hermite1stDerivativeToRef(t,i,s,n,o,r),r}static Hermite1stDerivativeToRef(t,i,s,n,o,r){let a=o*o;return r._x=(a-o)*6*t._x+(3*a-4*o+1)*i._x+(-a+o)*6*s._x+(3*a-2*o)*n._x,r._y=(a-o)*6*t._y+(3*a-4*o+1)*i._y+(-a+o)*6*s._y+(3*a-2*o)*n._y,r._z=(a-o)*6*t._z+(3*a-4*o+1)*i._z+(-a+o)*6*s._z+(3*a-2*o)*n._z,r._isDirty=!0,r}static Lerp(t,i,s){let n=new e(0,0,0);return e.LerpToRef(t,i,s,n),n}static LerpToRef(t,i,s,n){return n._x=t._x+(i._x-t._x)*s,n._y=t._y+(i._y-t._y)*s,n._z=t._z+(i._z-t._z)*s,n._isDirty=!0,n}static Dot(t,i){return t._x*i._x+t._y*i._y+t._z*i._z}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z}static Cross(t,i){let s=new e;return e.CrossToRef(t,i,s),s}static CrossToRef(t,i,s){let n=t._y*i._z-t._z*i._y,o=t._z*i._x-t._x*i._z,r=t._x*i._y-t._y*i._x;return s.copyFromFloats(n,o,r),s}static Normalize(t){let i=e.Zero();return e.NormalizeToRef(t,i),i}static NormalizeToRef(t,i){return t.normalizeToRef(i),i}static Project(t,i,s,n){let o=new e;return e.ProjectToRef(t,i,s,n,o),o}static ProjectToRef(t,i,s,n,o){let r=n.width,a=n.height,c=n.x,h=n.y,_=m.Matrix[1],y=nt.LastCreatedEngine?.isNDCHalfZRange,x=y?1:.5,z=y?0:.5;O.FromValuesToRef(r/2,0,0,0,0,-a/2,0,0,0,0,x,0,c+r/2,a/2+h,z,1,_);let R=m.Matrix[0];return i.multiplyToRef(s,R),R.multiplyToRef(_,R),e.TransformCoordinatesToRef(t,R,o),o}static Reflect(t,i){return this.ReflectToRef(t,i,new e)}static ReflectToRef(t,i,s){let n=U.Vector3[0];return n.copyFrom(i).scaleInPlace(2*e.Dot(t,i)),s.copyFrom(t).subtractInPlace(n)}static _UnprojectFromInvertedMatrixToRef(t,i,s){e.TransformCoordinatesToRef(t,i,s);let n=i.m,o=t._x*n[3]+t._y*n[7]+t._z*n[11]+n[15];return g(o,1)&&s.scaleInPlace(1/o),s}static UnprojectFromTransform(t,i,s,n,o){return this.Unproject(t,i,s,n,o,O.IdentityReadOnly)}static Unproject(t,i,s,n,o,r){let a=new e;return e.UnprojectToRef(t,i,s,n,o,r,a),a}static UnprojectToRef(t,i,s,n,o,r,a){return e.UnprojectFloatsToRef(t._x,t._y,t._z,i,s,n,o,r,a),a}static UnprojectFloatsToRef(t,i,s,n,o,r,a,c,h){let _=m.Matrix[0];r.multiplyToRef(a,_),_.multiplyToRef(c,_),_.invert();let y=m.Vector3[0];return y.x=t/n*2-1,y.y=-(i/o*2-1),nt.LastCreatedEngine?.isNDCHalfZRange?y.z=s:y.z=2*s-1,e._UnprojectFromInvertedMatrixToRef(y,_,h),h}static Minimize(t,i){let s=new e;return s.copyFrom(t),s.minimizeInPlace(i),s}static Maximize(t,i){let s=new e;return s.copyFrom(t),s.maximizeInPlace(i),s}static Distance(t,i){return Math.sqrt(e.DistanceSquared(t,i))}static DistanceSquared(t,i){let s=t._x-i._x,n=t._y-i._y,o=t._z-i._z;return s*s+n*n+o*o}static ProjectOnTriangleToRef(t,i,s,n,o){let r=m.Vector3[0],a=m.Vector3[1],c=m.Vector3[2],h=m.Vector3[3],_=m.Vector3[4];s.subtractToRef(i,r),n.subtractToRef(i,a),n.subtractToRef(s,c);let y=r.length(),x=a.length(),z=c.length();if(y<b||x<b||z<b)return o.copyFrom(i),e.Distance(t,i);t.subtractToRef(i,_),e.CrossToRef(r,a,h);let R=h.length();if(R<b)return o.copyFrom(i),e.Distance(t,i);h.normalizeFromLength(R);let T=_.length();if(T<b)return o.copyFrom(i),0;_.normalizeFromLength(T);let F=e.Dot(h,_),u=m.Vector3[5],f=m.Vector3[6];u.copyFrom(h).scaleInPlace(-T*F),f.copyFrom(t).addInPlace(u);let A=m.Vector3[4],w=m.Vector3[5],D=m.Vector3[7],l=m.Vector3[8];A.copyFrom(r).scaleInPlace(1/y),l.copyFrom(a).scaleInPlace(1/x),A.addInPlace(l).scaleInPlace(-1),w.copyFrom(r).scaleInPlace(-1/y),l.copyFrom(c).scaleInPlace(1/z),w.addInPlace(l).scaleInPlace(-1),D.copyFrom(c).scaleInPlace(-1/z),l.copyFrom(a).scaleInPlace(-1/x),D.addInPlace(l).scaleInPlace(-1);let I=m.Vector3[9],P;I.copyFrom(f).subtractInPlace(i),e.CrossToRef(A,I,l),P=e.Dot(l,h);let N=P;I.copyFrom(f).subtractInPlace(s),e.CrossToRef(w,I,l),P=e.Dot(l,h);let q=P;I.copyFrom(f).subtractInPlace(n),e.CrossToRef(D,I,l),P=e.Dot(l,h);let E=P,k=m.Vector3[10],C,M;N>0&&q<0?(k.copyFrom(r),C=i,M=s):q>0&&E<0?(k.copyFrom(c),C=s,M=n):(k.copyFrom(a).scaleInPlace(-1),C=n,M=i);let $=m.Vector3[9],Y=m.Vector3[4];if(C.subtractToRef(f,l),M.subtractToRef(f,$),e.CrossToRef(l,$,Y),!(e.Dot(Y,h)<0))return o.copyFrom(f),Math.abs(T*F);let Z=m.Vector3[5];e.CrossToRef(k,Y,Z),Z.normalize();let B=m.Vector3[9];B.copyFrom(C).subtractInPlace(f);let j=B.length();if(j<b)return o.copyFrom(C),e.Distance(t,C);B.normalizeFromLength(j);let V=e.Dot(Z,B),J=m.Vector3[7];J.copyFrom(f).addInPlace(Z.scaleInPlace(j*V)),l.copyFrom(J).subtractInPlace(C),T=k.length(),k.normalizeFromLength(T);let tt=e.Dot(l,k)/Math.max(T,b);return tt=L(tt,0,1),J.copyFrom(C).addInPlace(k.scaleInPlace(tt*T)),o.copyFrom(J),e.Distance(t,J)}static Center(t,i){return e.CenterToRef(t,i,e.Zero())}static CenterToRef(t,i,s){return s.copyFromFloats((t._x+i._x)/2,(t._y+i._y)/2,(t._z+i._z)/2)}static RotationFromAxis(t,i,s){let n=new e;return e.RotationFromAxisToRef(t,i,s,n),n}static RotationFromAxisToRef(t,i,s,n){let o=m.Quaternion[0];return S.RotationQuaternionFromAxisToRef(t,i,s,o),o.toEulerAnglesToRef(n),n}};d._V8PerformanceHack=new d(.5,.5,.5);d._UpReadOnly=d.Up();d._DownReadOnly=d.Down();d._LeftHandedForwardReadOnly=d.Forward(!1);d._RightHandedForwardReadOnly=d.Forward(!0);d._LeftHandedBackwardReadOnly=d.Backward(!1);d._RightHandedBackwardReadOnly=d.Backward(!0);d._RightReadOnly=d.Right();d._LeftReadOnly=d.Left();d._ZeroReadOnly=d.Zero();d._OneReadOnly=d.One();Object.defineProperties(d.prototype,{dimension:{value:[3]},rank:{value:1}});Q=class e{constructor(t=0,i=0,s=0,n=0){this.x=t,this.y=i,this.z=s,this.w=n}toString(){return`{X: ${this.x} Y: ${this.y} Z: ${this.z} W: ${this.w}}`}getClassName(){return"Vector4"}getHashCode(){let t=H(this.x),i=H(this.y),s=H(this.z),n=H(this.w),o=t;return o=o*397^i,o=o*397^s,o=o*397^n,o}asArray(){return[this.x,this.y,this.z,this.w]}toArray(t,i){return i===void 0&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,this}fromArray(t,i=0){return e.FromArrayToRef(t,i,this),this}addInPlace(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addInPlaceFromFloats(t,i,s,n){return this.x+=t,this.y+=i,this.z+=s,this.w+=n,this}add(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addToRef(t,i){return i.x=this.x+t.x,i.y=this.y+t.y,i.z=this.z+t.z,i.w=this.w+t.w,i}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subtract(t){return new e(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}subtractToRef(t,i){return i.x=this.x-t.x,i.y=this.y-t.y,i.z=this.z-t.z,i.w=this.w-t.w,i}subtractFromFloats(t,i,s,n){return new e(this.x-t,this.y-i,this.z-s,this.w-n)}subtractFromFloatsToRef(t,i,s,n,o){return o.x=this.x-t,o.y=this.y-i,o.z=this.z-s,o.w=this.w-n,o}negate(){return new e(-this.x,-this.y,-this.z,-this.w)}negateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this.w*=-1,this}negateToRef(t){return t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=-this.w,t}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}scale(t){return new e(this.x*t,this.y*t,this.z*t,this.w*t)}scaleToRef(t,i){return i.x=this.x*t,i.y=this.y*t,i.z=this.z*t,i.w=this.w*t,i}scaleAndAddToRef(t,i){return i.x+=this.x*t,i.y+=this.y*t,i.z+=this.z*t,i.w+=this.w*t,i}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}equalsWithEpsilon(t,i=b){return t&&g(this.x,t.x,i)&&g(this.y,t.y,i)&&g(this.z,t.z,i)&&g(this.w,t.w,i)}equalsToFloats(t,i,s,n){return this.x===t&&this.y===i&&this.z===s&&this.w===n}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiply(t){return new e(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)}multiplyToRef(t,i){return i.x=this.x*t.x,i.y=this.y*t.y,i.z=this.z*t.z,i.w=this.w*t.w,i}multiplyByFloats(t,i,s,n){return new e(this.x*t,this.y*i,this.z*s,this.w*n)}divide(t){return new e(this.x/t.x,this.y/t.y,this.z/t.z,this.w/t.w)}divideToRef(t,i){return i.x=this.x/t.x,i.y=this.y/t.y,i.z=this.z/t.z,i.w=this.w/t.w,i}divideInPlace(t){return this.divideToRef(t,this)}minimizeInPlace(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this}maximizeInPlace(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this}minimizeInPlaceFromFloats(t,i,s,n){return this.x=Math.min(t,this.x),this.y=Math.min(i,this.y),this.z=Math.min(s,this.z),this.w=Math.min(n,this.w),this}maximizeInPlaceFromFloats(t,i,s,n){return this.x=Math.max(t,this.x),this.y=Math.max(i,this.y),this.z=Math.max(s,this.z),this.w=Math.max(n,this.w),this}floorToRef(t){return t.x=Math.floor(this.x),t.y=Math.floor(this.y),t.z=Math.floor(this.z),t.w=Math.floor(this.w),t}floor(){return new e(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fractToRef(t){return t.x=this.x-Math.floor(this.x),t.y=this.y-Math.floor(this.y),t.z=this.z-Math.floor(this.z),t.w=this.w-Math.floor(this.w),t}fract(){return new e(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(t){return t===0||t===1?this:this.scaleInPlace(1/t)}normalizeToNew(){return this.normalizeToRef(new e)}normalizeToRef(t){let i=this.length();return i===0||i===1?(t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t):this.scaleToRef(1/i,t)}toVector3(){return new d(this.x,this.y,this.z)}clone(){return new e(this.x,this.y,this.z,this.w)}copyFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}copyFromFloats(t,i,s,n){return this.x=t,this.y=i,this.z=s,this.w=n,this}set(t,i,s,n){return this.copyFromFloats(t,i,s,n)}setAll(t){return this.x=this.y=this.z=this.w=t,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}static FromArray(t,i){return i||(i=0),new e(t[i],t[i+1],t[i+2],t[i+3])}static FromArrayToRef(t,i,s){return s.x=t[i],s.y=t[i+1],s.z=t[i+2],s.w=t[i+3],s}static FromFloatArrayToRef(t,i,s){return e.FromArrayToRef(t,i,s),s}static FromFloatsToRef(t,i,s,n,o){return o.x=t,o.y=i,o.z=s,o.w=n,o}static Zero(){return new e(0,0,0,0)}static One(){return new e(1,1,1,1)}static Random(t=0,i=1){return new e(p(t,i),p(t,i),p(t,i),p(t,i))}static RandomToRef(t=0,i=1,s){return s.x=p(t,i),s.y=p(t,i),s.z=p(t,i),s.w=p(t,i),s}static Clamp(t,i,s){return e.ClampToRef(t,i,s,new e)}static ClampToRef(t,i,s,n){return n.x=L(t.x,i.x,s.x),n.y=L(t.y,i.y,s.y),n.z=L(t.z,i.z,s.z),n.w=L(t.w,i.w,s.w),n}static CheckExtends(t,i,s){i.minimizeInPlace(t),s.maximizeInPlace(t)}static get ZeroReadOnly(){return e._ZeroReadOnly}static Normalize(t){return e.NormalizeToRef(t,new e)}static NormalizeToRef(t,i){return t.normalizeToRef(i),i}static Minimize(t,i){let s=new e;return s.copyFrom(t),s.minimizeInPlace(i),s}static Maximize(t,i){let s=new e;return s.copyFrom(t),s.maximizeInPlace(i),s}static Distance(t,i){return Math.sqrt(e.DistanceSquared(t,i))}static DistanceSquared(t,i){let s=t.x-i.x,n=t.y-i.y,o=t.z-i.z,r=t.w-i.w;return s*s+n*n+o*o+r*r}static Center(t,i){return e.CenterToRef(t,i,new e)}static CenterToRef(t,i,s){return s.x=(t.x+i.x)/2,s.y=(t.y+i.y)/2,s.z=(t.z+i.z)/2,s.w=(t.w+i.w)/2,s}static TransformCoordinates(t,i){return e.TransformCoordinatesToRef(t,i,new e)}static TransformCoordinatesToRef(t,i,s){return e.TransformCoordinatesFromFloatsToRef(t._x,t._y,t._z,i,s),s}static TransformCoordinatesFromFloatsToRef(t,i,s,n,o){let r=n.m,a=t*r[0]+i*r[4]+s*r[8]+r[12],c=t*r[1]+i*r[5]+s*r[9]+r[13],h=t*r[2]+i*r[6]+s*r[10]+r[14],_=t*r[3]+i*r[7]+s*r[11]+r[15];return o.x=a,o.y=c,o.z=h,o.w=_,o}static TransformNormal(t,i){return e.TransformNormalToRef(t,i,new e)}static TransformNormalToRef(t,i,s){let n=i.m,o=t.x*n[0]+t.y*n[4]+t.z*n[8],r=t.x*n[1]+t.y*n[5]+t.z*n[9],a=t.x*n[2]+t.y*n[6]+t.z*n[10];return s.x=o,s.y=r,s.z=a,s.w=t.w,s}static TransformNormalFromFloatsToRef(t,i,s,n,o,r){let a=o.m;return r.x=t*a[0]+i*a[4]+s*a[8],r.y=t*a[1]+i*a[5]+s*a[9],r.z=t*a[2]+i*a[6]+s*a[10],r.w=n,r}static FromVector3(t,i=0){return new e(t._x,t._y,t._z,i)}static Dot(t,i){return t.x*i.x+t.y*i.y+t.z*i.z+t.w*i.w}};Q._V8PerformanceHack=new Q(.5,.5,.5,.5);Q._ZeroReadOnly=Q.Zero();Object.defineProperties(Q.prototype,{dimension:{value:[4]},rank:{value:1}});S=class e{get x(){return this._x}set x(t){this._x=t,this._isDirty=!0}get y(){return this._y}set y(t){this._y=t,this._isDirty=!0}get z(){return this._z}set z(t){this._z=t,this._isDirty=!0}get w(){return this._w}set w(t){this._w=t,this._isDirty=!0}constructor(t=0,i=0,s=0,n=1){this._isDirty=!0,this._x=t,this._y=i,this._z=s,this._w=n}toString(){return`{X: ${this._x} Y: ${this._y} Z: ${this._z} W: ${this._w}}`}getClassName(){return"Quaternion"}getHashCode(){let t=H(this._x),i=H(this._y),s=H(this._z),n=H(this._w),o=t;return o=o*397^i,o=o*397^s,o=o*397^n,o}asArray(){return[this._x,this._y,this._z,this._w]}toArray(t,i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,this}fromArray(t,i=0){return e.FromArrayToRef(t,i,this)}equals(t){return t&&this._x===t._x&&this._y===t._y&&this._z===t._z&&this._w===t._w}equalsWithEpsilon(t,i=b){return t&&g(this._x,t._x,i)&&g(this._y,t._y,i)&&g(this._z,t._z,i)&&g(this._w,t._w,i)}clone(){return new e(this._x,this._y,this._z,this._w)}copyFrom(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._w=t._w,this._isDirty=!0,this}copyFromFloats(t,i,s,n){return this._x=t,this._y=i,this._z=s,this._w=n,this._isDirty=!0,this}set(t,i,s,n){return this.copyFromFloats(t,i,s,n)}setAll(t){return this.copyFromFloats(t,t,t,t)}add(t){return new e(this._x+t._x,this._y+t._y,this._z+t._z,this._w+t._w)}addInPlace(t){return this._x+=t._x,this._y+=t._y,this._z+=t._z,this._w+=t._w,this._isDirty=!0,this}addToRef(t,i){return i._x=this._x+t._x,i._y=this._y+t._y,i._z=this._z+t._z,i._w=this._w+t._w,i._isDirty=!0,i}addInPlaceFromFloats(t,i,s,n){return this._x+=t,this._y+=i,this._z+=s,this._w+=n,this._isDirty=!0,this}subtractToRef(t,i){return i._x=this._x-t._x,i._y=this._y-t._y,i._z=this._z-t._z,i._w=this._w-t._w,i._isDirty=!0,i}subtractFromFloats(t,i,s,n){return this.subtractFromFloatsToRef(t,i,s,n,new e)}subtractFromFloatsToRef(t,i,s,n,o){return o._x=this._x-t,o._y=this._y-i,o._z=this._z-s,o._w=this._w-n,o._isDirty=!0,o}subtract(t){return new e(this._x-t._x,this._y-t._y,this._z-t._z,this._w-t._w)}subtractInPlace(t){return this._x-=t._x,this._y-=t._y,this._z-=t._z,this._w-=t._w,this._isDirty=!0,this}scale(t){return new e(this._x*t,this._y*t,this._z*t,this._w*t)}scaleToRef(t,i){return i._x=this._x*t,i._y=this._y*t,i._z=this._z*t,i._w=this._w*t,i._isDirty=!0,i}scaleInPlace(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this._isDirty=!0,this}scaleAndAddToRef(t,i){return i._x+=this._x*t,i._y+=this._y*t,i._z+=this._z*t,i._w+=this._w*t,i._isDirty=!0,i}multiply(t){let i=new e(0,0,0,1);return this.multiplyToRef(t,i),i}multiplyToRef(t,i){let s=this._x*t._w+this._y*t._z-this._z*t._y+this._w*t._x,n=-this._x*t._z+this._y*t._w+this._z*t._x+this._w*t._y,o=this._x*t._y-this._y*t._x+this._z*t._w+this._w*t._z,r=-this._x*t._x-this._y*t._y-this._z*t._z+this._w*t._w;return i.copyFromFloats(s,n,o,r),i}multiplyInPlace(t){return this.multiplyToRef(t,this)}multiplyByFloats(t,i,s,n){return this._x*=t,this._y*=i,this._z*=s,this._w*=n,this._isDirty=!0,this}divide(t){throw new ReferenceError("Can not divide a quaternion")}divideToRef(t,i){throw new ReferenceError("Can not divide a quaternion")}divideInPlace(t){throw new ReferenceError("Can not divide a quaternion")}minimizeInPlace(){throw new ReferenceError("Can not minimize a quaternion")}minimizeInPlaceFromFloats(){throw new ReferenceError("Can not minimize a quaternion")}maximizeInPlace(){throw new ReferenceError("Can not maximize a quaternion")}maximizeInPlaceFromFloats(){throw new ReferenceError("Can not maximize a quaternion")}negate(){return this.negateToRef(new e)}negateInPlace(){return this._x=-this._x,this._y=-this._y,this._z=-this._z,this._w=-this._w,this._isDirty=!0,this}negateToRef(t){return t._x=-this._x,t._y=-this._y,t._z=-this._z,t._w=-this._w,t._isDirty=!0,t}equalsToFloats(t,i,s,n){return this._x===t&&this._y===i&&this._z===s&&this._w===n}floorToRef(t){throw new ReferenceError("Can not floor a quaternion")}floor(){throw new ReferenceError("Can not floor a quaternion")}fractToRef(t){throw new ReferenceError("Can not fract a quaternion")}fract(){throw new ReferenceError("Can not fract a quaternion")}conjugateToRef(t){return t.copyFromFloats(-this._x,-this._y,-this._z,this._w),t}conjugateInPlace(){return this._x*=-1,this._y*=-1,this._z*=-1,this._isDirty=!0,this}conjugate(){return new e(-this._x,-this._y,-this._z,this._w)}invert(){let t=this.conjugate(),i=this.lengthSquared();return i==0||i==1||t.scaleInPlace(1/i),t}invertInPlace(){this.conjugateInPlace();let t=this.lengthSquared();return t==0||t==1?this:(this.scaleInPlace(1/t),this)}lengthSquared(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this.lengthSquared())}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(t){return t===0||t===1?this:this.scaleInPlace(1/t)}normalizeToNew(){let t=new e(0,0,0,1);return this.normalizeToRef(t),t}normalizeToRef(t){let i=this.length();return i===0||i===1?t.copyFromFloats(this._x,this._y,this._z,this._w):this.scaleToRef(1/i,t)}toEulerAngles(){let t=d.Zero();return this.toEulerAnglesToRef(t),t}toEulerAnglesToRef(t){let i=this._z,s=this._x,n=this._y,o=this._w,r=n*i-s*o,a=.4999999;if(r<-a)t._y=2*Math.atan2(n,o),t._x=Math.PI/2,t._z=0,t._isDirty=!0;else if(r>a)t._y=2*Math.atan2(n,o),t._x=-Math.PI/2,t._z=0,t._isDirty=!0;else{let c=o*o,h=i*i,_=s*s,y=n*n;t._z=Math.atan2(2*(s*n+i*o),-h-_+y+c),t._x=Math.asin(-2*r),t._y=Math.atan2(2*(i*s+n*o),h-_-y+c),t._isDirty=!0}return t}toAlphaBetaGammaToRef(t){let i=this._z,s=this._x,n=this._y,o=this._w,r=Math.sqrt(s*s+n*n),a=Math.sqrt(i*i+o*o),c=2*Math.atan2(r,a),h=2*Math.atan2(i,o),_=2*Math.atan2(n,s),y=(h+_)/2,x=(h-_)/2;return t.set(x,c,y),t}toRotationMatrix(t){return O.FromQuaternionToRef(this,t),t}fromRotationMatrix(t){return e.FromRotationMatrixToRef(t,this),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}static FromRotationMatrix(t){let i=new e;return e.FromRotationMatrixToRef(t,i),i}static FromRotationMatrixToRef(t,i){let s=t.m,n=s[0],o=s[4],r=s[8],a=s[1],c=s[5],h=s[9],_=s[2],y=s[6],x=s[10],z=n+c+x,R;return z>0?(R=.5/Math.sqrt(z+1),i._w=.25/R,i._x=(y-h)*R,i._y=(r-_)*R,i._z=(a-o)*R,i._isDirty=!0):n>c&&n>x?(R=2*Math.sqrt(1+n-c-x),i._w=(y-h)/R,i._x=.25*R,i._y=(o+a)/R,i._z=(r+_)/R,i._isDirty=!0):c>x?(R=2*Math.sqrt(1+c-n-x),i._w=(r-_)/R,i._x=(o+a)/R,i._y=.25*R,i._z=(h+y)/R,i._isDirty=!0):(R=2*Math.sqrt(1+x-n-c),i._w=(a-o)/R,i._x=(r+_)/R,i._y=(h+y)/R,i._z=.25*R,i._isDirty=!0),i}static Dot(t,i){return t._x*i._x+t._y*i._y+t._z*i._z+t._w*i._w}static AreClose(t,i,s=.1){let n=e.Dot(t,i);return 1-n*n<=s}static SmoothToRef(t,i,s,n,o){let r=n===0?1:s/n;return r=L(r,0,1),e.SlerpToRef(t,i,r,o),o}static Zero(){return new e(0,0,0,0)}static Inverse(t){return new e(-t._x,-t._y,-t._z,t._w)}static InverseToRef(t,i){return i.set(-t._x,-t._y,-t._z,t._w),i}static Identity(){return new e(0,0,0,1)}static IsIdentity(t){return t&&t._x===0&&t._y===0&&t._z===0&&t._w===1}static RotationAxis(t,i){return e.RotationAxisToRef(t,i,new e)}static RotationAxisToRef(t,i,s){s._w=Math.cos(i/2);let n=Math.sin(i/2)/t.length();return s._x=t._x*n,s._y=t._y*n,s._z=t._z*n,s._isDirty=!0,s}static FromArray(t,i){return i||(i=0),new e(t[i],t[i+1],t[i+2],t[i+3])}static FromArrayToRef(t,i,s){return s._x=t[i],s._y=t[i+1],s._z=t[i+2],s._w=t[i+3],s._isDirty=!0,s}static FromFloatsToRef(t,i,s,n,o){return o.copyFromFloats(t,i,s,n),o}static FromEulerAngles(t,i,s){let n=new e;return e.RotationYawPitchRollToRef(i,t,s,n),n}static FromEulerAnglesToRef(t,i,s,n){return e.RotationYawPitchRollToRef(i,t,s,n),n}static FromEulerVector(t){let i=new e;return e.RotationYawPitchRollToRef(t._y,t._x,t._z,i),i}static FromEulerVectorToRef(t,i){return e.RotationYawPitchRollToRef(t._y,t._x,t._z,i),i}static FromUnitVectorsToRef(t,i,s,n=b){let o=d.Dot(t,i)+1;return o<n?Math.abs(t.x)>Math.abs(t.z)?s.set(-t.y,t.x,0,0):s.set(0,-t.z,t.y,0):(d.CrossToRef(t,i,U.Vector3[0]),s.set(U.Vector3[0].x,U.Vector3[0].y,U.Vector3[0].z,o)),s.normalize()}static RotationYawPitchRoll(t,i,s){let n=new e;return e.RotationYawPitchRollToRef(t,i,s,n),n}static RotationYawPitchRollToRef(t,i,s,n){let o=s*.5,r=i*.5,a=t*.5,c=Math.sin(o),h=Math.cos(o),_=Math.sin(r),y=Math.cos(r),x=Math.sin(a),z=Math.cos(a);return n._x=z*_*h+x*y*c,n._y=x*y*h-z*_*c,n._z=z*y*c-x*_*h,n._w=z*y*h+x*_*c,n._isDirty=!0,n}static RotationAlphaBetaGamma(t,i,s){let n=new e;return e.RotationAlphaBetaGammaToRef(t,i,s,n),n}static RotationAlphaBetaGammaToRef(t,i,s,n){let o=(s+t)*.5,r=(s-t)*.5,a=i*.5;return n._x=Math.cos(r)*Math.sin(a),n._y=Math.sin(r)*Math.sin(a),n._z=Math.sin(o)*Math.cos(a),n._w=Math.cos(o)*Math.cos(a),n._isDirty=!0,n}static RotationQuaternionFromAxis(t,i,s){let n=new e(0,0,0,0);return e.RotationQuaternionFromAxisToRef(t,i,s,n),n}static RotationQuaternionFromAxisToRef(t,i,s,n){let o=m.Matrix[0];return t=t.normalizeToRef(m.Vector3[0]),i=i.normalizeToRef(m.Vector3[1]),s=s.normalizeToRef(m.Vector3[2]),O.FromXYZAxesToRef(t,i,s,o),e.FromRotationMatrixToRef(o,n),n}static FromLookDirectionLH(t,i){let s=new e;return e.FromLookDirectionLHToRef(t,i,s),s}static FromLookDirectionLHToRef(t,i,s){let n=m.Matrix[0];return O.LookDirectionLHToRef(t,i,n),e.FromRotationMatrixToRef(n,s),s}static FromLookDirectionRH(t,i){let s=new e;return e.FromLookDirectionRHToRef(t,i,s),s}static FromLookDirectionRHToRef(t,i,s){let n=m.Matrix[0];return O.LookDirectionRHToRef(t,i,n),e.FromRotationMatrixToRef(n,s)}static Slerp(t,i,s){let n=e.Identity();return e.SlerpToRef(t,i,s,n),n}static SlerpToRef(t,i,s,n){let o,r,a=t._x*i._x+t._y*i._y+t._z*i._z+t._w*i._w,c=!1;if(a<0&&(c=!0,a=-a),a>.999999)r=1-s,o=c?-s:s;else{let h=Math.acos(a),_=1/Math.sin(h);r=Math.sin((1-s)*h)*_,o=c?-Math.sin(s*h)*_:Math.sin(s*h)*_}return n._x=r*t._x+o*i._x,n._y=r*t._y+o*i._y,n._z=r*t._z+o*i._z,n._w=r*t._w+o*i._w,n._isDirty=!0,n}static Hermite(t,i,s,n,o){let r=o*o,a=o*r,c=2*a-3*r+1,h=-2*a+3*r,_=a-2*r+o,y=a-r,x=t._x*c+s._x*h+i._x*_+n._x*y,z=t._y*c+s._y*h+i._y*_+n._y*y,R=t._z*c+s._z*h+i._z*_+n._z*y,T=t._w*c+s._w*h+i._w*_+n._w*y;return new e(x,z,R,T)}static Hermite1stDerivative(t,i,s,n,o){let r=new e;return this.Hermite1stDerivativeToRef(t,i,s,n,o,r),r}static Hermite1stDerivativeToRef(t,i,s,n,o,r){let a=o*o;return r._x=(a-o)*6*t._x+(3*a-4*o+1)*i._x+(-a+o)*6*s._x+(3*a-2*o)*n._x,r._y=(a-o)*6*t._y+(3*a-4*o+1)*i._y+(-a+o)*6*s._y+(3*a-2*o)*n._y,r._z=(a-o)*6*t._z+(3*a-4*o+1)*i._z+(-a+o)*6*s._z+(3*a-2*o)*n._z,r._w=(a-o)*6*t._w+(3*a-4*o+1)*i._w+(-a+o)*6*s._w+(3*a-2*o)*n._w,r._isDirty=!0,r}static Normalize(t){let i=e.Zero();return e.NormalizeToRef(t,i),i}static NormalizeToRef(t,i){return t.normalizeToRef(i),i}static Clamp(t,i,s){let n=new e;return e.ClampToRef(t,i,s,n),n}static ClampToRef(t,i,s,n){return n.copyFromFloats(L(t.x,i.x,s.x),L(t.y,i.y,s.y),L(t.z,i.z,s.z),L(t.w,i.w,s.w))}static Random(t=0,i=1){return new e(p(t,i),p(t,i),p(t,i),p(t,i))}static RandomToRef(t=0,i=1,s){return s.copyFromFloats(p(t,i),p(t,i),p(t,i),p(t,i))}static Minimize(){throw new ReferenceError("Quaternion.Minimize does not make sense")}static Maximize(){throw new ReferenceError("Quaternion.Maximize does not make sense")}static Distance(t,i){return Math.sqrt(e.DistanceSquared(t,i))}static DistanceSquared(t,i){let s=t.x-i.x,n=t.y-i.y,o=t.z-i.z,r=t.w-i.w;return s*s+n*n+o*o+r*r}static Center(t,i){return e.CenterToRef(t,i,e.Zero())}static CenterToRef(t,i,s){return s.copyFromFloats((t.x+i.x)/2,(t.y+i.y)/2,(t.z+i.z)/2,(t.w+i.w)/2)}};S._V8PerformanceHack=new S(.5,.5,.5,.5);Object.defineProperties(S.prototype,{dimension:{value:[4]},rank:{value:1}});O=class e{static get Use64Bits(){return K.MatrixUse64Bits}get m(){return this._m}markAsUpdated(){this.updateFlag=e._UpdateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}_updateIdentityStatus(t,i=!1,s=!1,n=!0){this._isIdentity=t,this._isIdentity3x2=t||s,this._isIdentityDirty=this._isIdentity?!1:i,this._isIdentity3x2Dirty=this._isIdentity3x2?!1:n}constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this.updateFlag=-1,K.MatrixTrackPrecisionChange&&K.MatrixTrackedMatrices.push(this),this._m=new K.MatrixCurrentType(16),this.markAsUpdated()}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;let t=this._m;this._isIdentity=t[0]===1&&t[1]===0&&t[2]===0&&t[3]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[7]===0&&t[8]===0&&t[9]===0&&t[10]===1&&t[11]===0&&t[12]===0&&t[13]===0&&t[14]===0&&t[15]===1}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,this._m[0]!==1||this._m[5]!==1||this._m[15]!==1?this._isIdentity3x2=!1:this._m[1]!==0||this._m[2]!==0||this._m[3]!==0||this._m[4]!==0||this._m[6]!==0||this._m[7]!==0||this._m[8]!==0||this._m[9]!==0||this._m[10]!==0||this._m[11]!==0||this._m[12]!==0||this._m[13]!==0||this._m[14]!==0?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(this._isIdentity===!0)return 1;let t=this._m,i=t[0],s=t[1],n=t[2],o=t[3],r=t[4],a=t[5],c=t[6],h=t[7],_=t[8],y=t[9],x=t[10],z=t[11],R=t[12],T=t[13],F=t[14],u=t[15],f=x*u-F*z,A=y*u-T*z,w=y*F-T*x,D=_*u-R*z,l=_*F-x*R,I=_*T-R*y,P=+(a*f-c*A+h*w),N=-(r*f-c*D+h*l),q=+(r*A-a*D+h*I),E=-(r*w-a*l+c*I);return i*P+s*N+n*q+o*E}toString(){return`{${this.m[0]}, ${this.m[1]}, ${this.m[2]}, ${this.m[3]}
${this.m[4]}, ${this.m[5]}, ${this.m[6]}, ${this.m[7]}
${this.m[8]}, ${this.m[9]}, ${this.m[10]}, ${this.m[11]}
${this.m[12]}, ${this.m[13]}, ${this.m[14]}, ${this.m[15]}}`}toArray(t=null,i=0){if(!t)return this._m;let s=this._m;for(let n=0;n<16;n++)t[i+n]=s[n];return this}asArray(){return this._m}fromArray(t,i=0){return e.FromArrayToRef(t,i,this)}copyFromFloats(...t){return e.FromArrayToRef(t,0,this)}set(...t){let i=this._m;for(let s=0;s<16;s++)i[s]=t[s];return this.markAsUpdated(),this}setAll(t){let i=this._m;for(let s=0;s<16;s++)i[s]=t;return this.markAsUpdated(),this}invert(){return this.invertToRef(this),this}reset(){return e.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(t){let i=new e;return this.addToRef(t,i),i}addToRef(t,i){let s=this._m,n=i._m,o=t.m;for(let r=0;r<16;r++)n[r]=s[r]+o[r];return i.markAsUpdated(),i}addToSelf(t){let i=this._m,s=t.m;return i[0]+=s[0],i[1]+=s[1],i[2]+=s[2],i[3]+=s[3],i[4]+=s[4],i[5]+=s[5],i[6]+=s[6],i[7]+=s[7],i[8]+=s[8],i[9]+=s[9],i[10]+=s[10],i[11]+=s[11],i[12]+=s[12],i[13]+=s[13],i[14]+=s[14],i[15]+=s[15],this.markAsUpdated(),this}addInPlace(t){let i=this._m,s=t.m;for(let n=0;n<16;n++)i[n]+=s[n];return this.markAsUpdated(),this}addInPlaceFromFloats(...t){let i=this._m;for(let s=0;s<16;s++)i[s]+=t[s];return this.markAsUpdated(),this}subtract(t){let i=this._m,s=t.m;for(let n=0;n<16;n++)i[n]-=s[n];return this.markAsUpdated(),this}subtractToRef(t,i){let s=this._m,n=t.m,o=i._m;for(let r=0;r<16;r++)o[r]=s[r]-n[r];return i.markAsUpdated(),i}subtractInPlace(t){let i=this._m,s=t.m;for(let n=0;n<16;n++)i[n]-=s[n];return this.markAsUpdated(),this}subtractFromFloats(...t){return this.subtractFromFloatsToRef(...t,new e)}subtractFromFloatsToRef(...t){let i=t.pop(),s=this._m,n=i._m,o=t;for(let r=0;r<16;r++)n[r]=s[r]-o[r];return i.markAsUpdated(),i}invertToRef(t){if(this._isIdentity===!0)return e.IdentityToRef(t),t;let i=this._m,s=i[0],n=i[1],o=i[2],r=i[3],a=i[4],c=i[5],h=i[6],_=i[7],y=i[8],x=i[9],z=i[10],R=i[11],T=i[12],F=i[13],u=i[14],f=i[15],A=z*f-u*R,w=x*f-F*R,D=x*u-F*z,l=y*f-T*R,I=y*u-z*T,P=y*F-T*x,N=+(c*A-h*w+_*D),q=-(a*A-h*l+_*I),E=+(a*w-c*l+_*P),k=-(a*D-c*I+h*P),C=s*N+n*q+o*E+r*k;if(C===0)return t.copyFrom(this),t;let M=1/C,$=h*f-u*_,Y=c*f-F*_,W=c*u-F*h,Z=a*f-T*_,B=a*u-T*h,j=a*F-T*c,V=h*R-z*_,J=c*R-x*_,tt=c*z-x*h,ot=a*R-y*_,rt=a*z-y*h,et=a*x-y*c,yt=-(n*A-o*w+r*D),mt=+(s*A-o*l+r*I),xt=-(s*w-n*l+r*P),Rt=+(s*D-n*I+o*P),ft=+(n*$-o*Y+r*W),zt=-(s*$-o*Z+r*B),dt=+(s*Y-n*Z+r*j),Tt=-(s*W-n*B+o*j),wt=-(n*V-o*J+r*tt),ut=+(s*V-o*ot+r*rt),Ft=-(s*J-n*ot+r*et),lt=+(s*tt-n*rt+o*et);return e.FromValuesToRef(N*M,yt*M,ft*M,wt*M,q*M,mt*M,zt*M,ut*M,E*M,xt*M,dt*M,Ft*M,k*M,Rt*M,Tt*M,lt*M,t),t}addAtIndex(t,i){return this._m[t]+=i,this.markAsUpdated(),this}multiplyAtIndex(t,i){return this._m[t]*=i,this.markAsUpdated(),this}setTranslationFromFloats(t,i,s){return this._m[12]=t,this._m[13]=i,this._m[14]=s,this.markAsUpdated(),this}addTranslationFromFloats(t,i,s){return this._m[12]+=t,this._m[13]+=i,this._m[14]+=s,this.markAsUpdated(),this}setTranslation(t){return this.setTranslationFromFloats(t._x,t._y,t._z)}getTranslation(){return new d(this._m[12],this._m[13],this._m[14])}getTranslationToRef(t){return t.x=this._m[12],t.y=this._m[13],t.z=this._m[14],t}removeRotationAndScaling(){let t=this.m;return e.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t[12],t[13],t[14],t[15],this),this._updateIdentityStatus(t[12]===0&&t[13]===0&&t[14]===0&&t[15]===1),this}copyFrom(t){t.copyToArray(this._m);let i=t;return this.updateFlag=i.updateFlag,this._updateIdentityStatus(i._isIdentity,i._isIdentityDirty,i._isIdentity3x2,i._isIdentity3x2Dirty),this}copyToArray(t,i=0){let s=this._m;return t[i]=s[0],t[i+1]=s[1],t[i+2]=s[2],t[i+3]=s[3],t[i+4]=s[4],t[i+5]=s[5],t[i+6]=s[6],t[i+7]=s[7],t[i+8]=s[8],t[i+9]=s[9],t[i+10]=s[10],t[i+11]=s[11],t[i+12]=s[12],t[i+13]=s[13],t[i+14]=s[14],t[i+15]=s[15],this}multiply(t){let i=new e;return this.multiplyToRef(t,i),i}multiplyInPlace(t){let i=this._m,s=t.m;for(let n=0;n<16;n++)i[n]*=s[n];return this.markAsUpdated(),this}multiplyByFloats(...t){let i=this._m;for(let s=0;s<16;s++)i[s]*=t[s];return this.markAsUpdated(),this}multiplyByFloatsToRef(...t){let i=t.pop(),s=this._m,n=i._m,o=t;for(let r=0;r<16;r++)n[r]=s[r]*o[r];return i.markAsUpdated(),i}multiplyToRef(t,i){return this._isIdentity?(i.copyFrom(t),i):t._isIdentity?(i.copyFrom(this),i):(this.multiplyToArray(t,i._m,0),i.markAsUpdated(),i)}multiplyToArray(t,i,s){let n=this._m,o=t.m,r=n[0],a=n[1],c=n[2],h=n[3],_=n[4],y=n[5],x=n[6],z=n[7],R=n[8],T=n[9],F=n[10],u=n[11],f=n[12],A=n[13],w=n[14],D=n[15],l=o[0],I=o[1],P=o[2],N=o[3],q=o[4],E=o[5],k=o[6],C=o[7],M=o[8],$=o[9],Y=o[10],W=o[11],Z=o[12],B=o[13],j=o[14],V=o[15];return i[s]=r*l+a*q+c*M+h*Z,i[s+1]=r*I+a*E+c*$+h*B,i[s+2]=r*P+a*k+c*Y+h*j,i[s+3]=r*N+a*C+c*W+h*V,i[s+4]=_*l+y*q+x*M+z*Z,i[s+5]=_*I+y*E+x*$+z*B,i[s+6]=_*P+y*k+x*Y+z*j,i[s+7]=_*N+y*C+x*W+z*V,i[s+8]=R*l+T*q+F*M+u*Z,i[s+9]=R*I+T*E+F*$+u*B,i[s+10]=R*P+T*k+F*Y+u*j,i[s+11]=R*N+T*C+F*W+u*V,i[s+12]=f*l+A*q+w*M+D*Z,i[s+13]=f*I+A*E+w*$+D*B,i[s+14]=f*P+A*k+w*Y+D*j,i[s+15]=f*N+A*C+w*W+D*V,this}divide(t){return this.divideToRef(t,new e)}divideToRef(t,i){let s=this._m,n=t.m,o=i._m;for(let r=0;r<16;r++)o[r]=s[r]/n[r];return i.markAsUpdated(),i}divideInPlace(t){let i=this._m,s=t.m;for(let n=0;n<16;n++)i[n]/=s[n];return this.markAsUpdated(),this}minimizeInPlace(t){let i=this._m,s=t.m;for(let n=0;n<16;n++)i[n]=Math.min(i[n],s[n]);return this.markAsUpdated(),this}minimizeInPlaceFromFloats(...t){let i=this._m;for(let s=0;s<16;s++)i[s]=Math.min(i[s],t[s]);return this.markAsUpdated(),this}maximizeInPlace(t){let i=this._m,s=t.m;for(let n=0;n<16;n++)i[n]=Math.min(i[n],s[n]);return this.markAsUpdated(),this}maximizeInPlaceFromFloats(...t){let i=this._m;for(let s=0;s<16;s++)i[s]=Math.min(i[s],t[s]);return this.markAsUpdated(),this}negate(){return this.negateToRef(new e)}negateInPlace(){let t=this._m;for(let i=0;i<16;i++)t[i]=-t[i];return this.markAsUpdated(),this}negateToRef(t){let i=this._m,s=t._m;for(let n=0;n<16;n++)s[n]=-i[n];return t.markAsUpdated(),t}equals(t){let i=t;if(!i)return!1;if((this._isIdentity||i._isIdentity)&&!this._isIdentityDirty&&!i._isIdentityDirty)return this._isIdentity&&i._isIdentity;let s=this.m,n=i.m;return s[0]===n[0]&&s[1]===n[1]&&s[2]===n[2]&&s[3]===n[3]&&s[4]===n[4]&&s[5]===n[5]&&s[6]===n[6]&&s[7]===n[7]&&s[8]===n[8]&&s[9]===n[9]&&s[10]===n[10]&&s[11]===n[11]&&s[12]===n[12]&&s[13]===n[13]&&s[14]===n[14]&&s[15]===n[15]}equalsWithEpsilon(t,i=0){let s=this._m,n=t.m;for(let o=0;o<16;o++)if(!g(s[o],n[o],i))return!1;return!0}equalsToFloats(...t){let i=this._m;for(let s=0;s<16;s++)if(i[s]!=t[s])return!1;return!0}floor(){return this.floorToRef(new e)}floorToRef(t){let i=this._m,s=t._m;for(let n=0;n<16;n++)s[n]=Math.floor(i[n]);return t.markAsUpdated(),t}fract(){return this.fractToRef(new e)}fractToRef(t){let i=this._m,s=t._m;for(let n=0;n<16;n++)s[n]=i[n]-Math.floor(i[n]);return t.markAsUpdated(),t}clone(){let t=new e;return t.copyFrom(this),t}getClassName(){return"Matrix"}getHashCode(){let t=H(this._m[0]);for(let i=1;i<16;i++)t=t*397^H(this._m[i]);return t}decomposeToTransformNode(t){return t.rotationQuaternion=t.rotationQuaternion||new S,this.decompose(t.scaling,t.rotationQuaternion,t.position)}decompose(t,i,s,n,o=!0){if(this._isIdentity)return s&&s.setAll(0),t&&t.setAll(1),i&&i.copyFromFloats(0,0,0,1),!0;let r=this._m;if(s&&s.copyFromFloats(r[12],r[13],r[14]),t=t||m.Vector3[0],t.x=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]),t.y=Math.sqrt(r[4]*r[4]+r[5]*r[5]+r[6]*r[6]),t.z=Math.sqrt(r[8]*r[8]+r[9]*r[9]+r[10]*r[10]),n){let a=(o?n.absoluteScaling.x:n.scaling.x)<0?-1:1,c=(o?n.absoluteScaling.y:n.scaling.y)<0?-1:1,h=(o?n.absoluteScaling.z:n.scaling.z)<0?-1:1;t.x*=a,t.y*=c,t.z*=h}else this.determinant()<=0&&(t.y*=-1);if(t._x===0||t._y===0||t._z===0)return i&&i.copyFromFloats(0,0,0,1),!1;if(i){let a=1/t._x,c=1/t._y,h=1/t._z;e.FromValuesToRef(r[0]*a,r[1]*a,r[2]*a,0,r[4]*c,r[5]*c,r[6]*c,0,r[8]*h,r[9]*h,r[10]*h,0,0,0,0,1,m.Matrix[0]),S.FromRotationMatrixToRef(m.Matrix[0],i)}return!0}getRow(t){if(t<0||t>3)return null;let i=t*4;return new Q(this._m[i+0],this._m[i+1],this._m[i+2],this._m[i+3])}getRowToRef(t,i){if(t>=0&&t<=3){let s=t*4;i.x=this._m[s+0],i.y=this._m[s+1],i.z=this._m[s+2],i.w=this._m[s+3]}return i}setRow(t,i){return this.setRowFromFloats(t,i.x,i.y,i.z,i.w)}transpose(){let t=new e;return e.TransposeToRef(this,t),t}transposeToRef(t){return e.TransposeToRef(this,t),t}setRowFromFloats(t,i,s,n,o){if(t<0||t>3)return this;let r=t*4;return this._m[r+0]=i,this._m[r+1]=s,this._m[r+2]=n,this._m[r+3]=o,this.markAsUpdated(),this}scale(t){let i=new e;return this.scaleToRef(t,i),i}scaleToRef(t,i){for(let s=0;s<16;s++)i._m[s]=this._m[s]*t;return i.markAsUpdated(),i}scaleAndAddToRef(t,i){for(let s=0;s<16;s++)i._m[s]+=this._m[s]*t;return i.markAsUpdated(),i}scaleInPlace(t){let i=this._m;for(let s=0;s<16;s++)i[s]*=t;return this.markAsUpdated(),this}toNormalMatrix(t){let i=m.Matrix[0];this.invertToRef(i),i.transposeToRef(t);let s=t._m;return e.FromValuesToRef(s[0],s[1],s[2],0,s[4],s[5],s[6],0,s[8],s[9],s[10],0,0,0,0,1,t),t}getRotationMatrix(){let t=new e;return this.getRotationMatrixToRef(t),t}getRotationMatrixToRef(t){let i=m.Vector3[0];if(!this.decompose(i))return e.IdentityToRef(t),t;let s=this._m,n=1/i._x,o=1/i._y,r=1/i._z;return e.FromValuesToRef(s[0]*n,s[1]*n,s[2]*n,0,s[4]*o,s[5]*o,s[6]*o,0,s[8]*r,s[9]*r,s[10]*r,0,0,0,0,1,t),t}toggleModelMatrixHandInPlace(){let t=this._m;return t[2]*=-1,t[6]*=-1,t[8]*=-1,t[9]*=-1,t[14]*=-1,this.markAsUpdated(),this}toggleProjectionMatrixHandInPlace(){let t=this._m;return t[8]*=-1,t[9]*=-1,t[10]*=-1,t[11]*=-1,this.markAsUpdated(),this}static FromArray(t,i=0){let s=new e;return e.FromArrayToRef(t,i,s),s}static FromArrayToRef(t,i,s){for(let n=0;n<16;n++)s._m[n]=t[n+i];return s.markAsUpdated(),s}static FromFloat32ArrayToRefScaled(t,i,s,n){return n._m[0]=t[0+i]*s,n._m[1]=t[1+i]*s,n._m[2]=t[2+i]*s,n._m[3]=t[3+i]*s,n._m[4]=t[4+i]*s,n._m[5]=t[5+i]*s,n._m[6]=t[6+i]*s,n._m[7]=t[7+i]*s,n._m[8]=t[8+i]*s,n._m[9]=t[9+i]*s,n._m[10]=t[10+i]*s,n._m[11]=t[11+i]*s,n._m[12]=t[12+i]*s,n._m[13]=t[13+i]*s,n._m[14]=t[14+i]*s,n._m[15]=t[15+i]*s,n.markAsUpdated(),n}static get IdentityReadOnly(){return e._IdentityReadOnly}static FromValuesToRef(t,i,s,n,o,r,a,c,h,_,y,x,z,R,T,F,u){let f=u._m;f[0]=t,f[1]=i,f[2]=s,f[3]=n,f[4]=o,f[5]=r,f[6]=a,f[7]=c,f[8]=h,f[9]=_,f[10]=y,f[11]=x,f[12]=z,f[13]=R,f[14]=T,f[15]=F,u.markAsUpdated()}static FromValues(t,i,s,n,o,r,a,c,h,_,y,x,z,R,T,F){let u=new e,f=u._m;return f[0]=t,f[1]=i,f[2]=s,f[3]=n,f[4]=o,f[5]=r,f[6]=a,f[7]=c,f[8]=h,f[9]=_,f[10]=y,f[11]=x,f[12]=z,f[13]=R,f[14]=T,f[15]=F,u.markAsUpdated(),u}static Compose(t,i,s){let n=new e;return e.ComposeToRef(t,i,s,n),n}static ComposeToRef(t,i,s,n){let o=n._m,r=i._x,a=i._y,c=i._z,h=i._w,_=r+r,y=a+a,x=c+c,z=r*_,R=r*y,T=r*x,F=a*y,u=a*x,f=c*x,A=h*_,w=h*y,D=h*x,l=t._x,I=t._y,P=t._z;return o[0]=(1-(F+f))*l,o[1]=(R+D)*l,o[2]=(T-w)*l,o[3]=0,o[4]=(R-D)*I,o[5]=(1-(z+f))*I,o[6]=(u+A)*I,o[7]=0,o[8]=(T+w)*P,o[9]=(u-A)*P,o[10]=(1-(z+F))*P,o[11]=0,o[12]=s._x,o[13]=s._y,o[14]=s._z,o[15]=1,n.markAsUpdated(),n}static Identity(){let t=e.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return t._updateIdentityStatus(!0),t}static IdentityToRef(t){return e.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,t),t._updateIdentityStatus(!0),t}static Zero(){let t=e.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return t._updateIdentityStatus(!1),t}static RotationX(t){let i=new e;return e.RotationXToRef(t,i),i}static Invert(t){let i=new e;return t.invertToRef(i),i}static RotationXToRef(t,i){let s=Math.sin(t),n=Math.cos(t);return e.FromValuesToRef(1,0,0,0,0,n,s,0,0,-s,n,0,0,0,0,1,i),i._updateIdentityStatus(n===1&&s===0),i}static RotationY(t){let i=new e;return e.RotationYToRef(t,i),i}static RotationYToRef(t,i){let s=Math.sin(t),n=Math.cos(t);return e.FromValuesToRef(n,0,-s,0,0,1,0,0,s,0,n,0,0,0,0,1,i),i._updateIdentityStatus(n===1&&s===0),i}static RotationZ(t){let i=new e;return e.RotationZToRef(t,i),i}static RotationZToRef(t,i){let s=Math.sin(t),n=Math.cos(t);return e.FromValuesToRef(n,s,0,0,-s,n,0,0,0,0,1,0,0,0,0,1,i),i._updateIdentityStatus(n===1&&s===0),i}static RotationAxis(t,i){let s=new e;return e.RotationAxisToRef(t,i,s),s}static RotationAxisToRef(t,i,s){let n=Math.sin(-i),o=Math.cos(-i),r=1-o;t=t.normalizeToRef(m.Vector3[0]);let a=s._m;return a[0]=t._x*t._x*r+o,a[1]=t._x*t._y*r-t._z*n,a[2]=t._x*t._z*r+t._y*n,a[3]=0,a[4]=t._y*t._x*r+t._z*n,a[5]=t._y*t._y*r+o,a[6]=t._y*t._z*r-t._x*n,a[7]=0,a[8]=t._z*t._x*r-t._y*n,a[9]=t._z*t._y*r+t._x*n,a[10]=t._z*t._z*r+o,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,s.markAsUpdated(),s}static RotationAlignToRef(t,i,s,n=!1){let o=d.Dot(i,t),r=s._m;if(o<-1+b)r[0]=-1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n?1:-1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=n?-1:1,r[11]=0;else{let a=d.Cross(i,t),c=1/(1+o);r[0]=a._x*a._x*c+o,r[1]=a._y*a._x*c-a._z,r[2]=a._z*a._x*c+a._y,r[3]=0,r[4]=a._x*a._y*c+a._z,r[5]=a._y*a._y*c+o,r[6]=a._z*a._y*c-a._x,r[7]=0,r[8]=a._x*a._z*c-a._y,r[9]=a._y*a._z*c+a._x,r[10]=a._z*a._z*c+o,r[11]=0}return r[12]=0,r[13]=0,r[14]=0,r[15]=1,s.markAsUpdated(),s}static RotationYawPitchRoll(t,i,s){let n=new e;return e.RotationYawPitchRollToRef(t,i,s,n),n}static RotationYawPitchRollToRef(t,i,s,n){return S.RotationYawPitchRollToRef(t,i,s,m.Quaternion[0]),m.Quaternion[0].toRotationMatrix(n),n}static Scaling(t,i,s){let n=new e;return e.ScalingToRef(t,i,s,n),n}static ScalingToRef(t,i,s,n){return e.FromValuesToRef(t,0,0,0,0,i,0,0,0,0,s,0,0,0,0,1,n),n._updateIdentityStatus(t===1&&i===1&&s===1),n}static Translation(t,i,s){let n=new e;return e.TranslationToRef(t,i,s,n),n}static TranslationToRef(t,i,s,n){return e.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t,i,s,1,n),n._updateIdentityStatus(t===0&&i===0&&s===0),n}static Lerp(t,i,s){let n=new e;return e.LerpToRef(t,i,s,n),n}static LerpToRef(t,i,s,n){let o=n._m,r=t.m,a=i.m;for(let c=0;c<16;c++)o[c]=r[c]*(1-s)+a[c]*s;return n.markAsUpdated(),n}static DecomposeLerp(t,i,s){let n=new e;return e.DecomposeLerpToRef(t,i,s,n),n}static DecomposeLerpToRef(t,i,s,n){let o=m.Vector3[0],r=m.Quaternion[0],a=m.Vector3[1];t.decompose(o,r,a);let c=m.Vector3[2],h=m.Quaternion[1],_=m.Vector3[3];i.decompose(c,h,_);let y=m.Vector3[4];d.LerpToRef(o,c,s,y);let x=m.Quaternion[2];S.SlerpToRef(r,h,s,x);let z=m.Vector3[5];return d.LerpToRef(a,_,s,z),e.ComposeToRef(y,x,z,n),n}static LookAtLH(t,i,s){let n=new e;return e.LookAtLHToRef(t,i,s,n),n}static LookAtLHToRef(t,i,s,n){let o=m.Vector3[0],r=m.Vector3[1],a=m.Vector3[2];i.subtractToRef(t,a),a.normalize(),d.CrossToRef(s,a,o);let c=o.lengthSquared();c===0?o.x=1:o.normalizeFromLength(Math.sqrt(c)),d.CrossToRef(a,o,r),r.normalize();let h=-d.Dot(o,t),_=-d.Dot(r,t),y=-d.Dot(a,t);return e.FromValuesToRef(o._x,r._x,a._x,0,o._y,r._y,a._y,0,o._z,r._z,a._z,0,h,_,y,1,n),n}static LookAtRH(t,i,s){let n=new e;return e.LookAtRHToRef(t,i,s,n),n}static LookAtRHToRef(t,i,s,n){let o=m.Vector3[0],r=m.Vector3[1],a=m.Vector3[2];t.subtractToRef(i,a),a.normalize(),d.CrossToRef(s,a,o);let c=o.lengthSquared();c===0?o.x=1:o.normalizeFromLength(Math.sqrt(c)),d.CrossToRef(a,o,r),r.normalize();let h=-d.Dot(o,t),_=-d.Dot(r,t),y=-d.Dot(a,t);return e.FromValuesToRef(o._x,r._x,a._x,0,o._y,r._y,a._y,0,o._z,r._z,a._z,0,h,_,y,1,n),n}static LookDirectionLH(t,i){let s=new e;return e.LookDirectionLHToRef(t,i,s),s}static LookDirectionLHToRef(t,i,s){let n=m.Vector3[0];n.copyFrom(t),n.scaleInPlace(-1);let o=m.Vector3[1];return d.CrossToRef(i,n,o),e.FromValuesToRef(o._x,o._y,o._z,0,i._x,i._y,i._z,0,n._x,n._y,n._z,0,0,0,0,1,s),s}static LookDirectionRH(t,i){let s=new e;return e.LookDirectionRHToRef(t,i,s),s}static LookDirectionRHToRef(t,i,s){let n=m.Vector3[2];return d.CrossToRef(i,t,n),e.FromValuesToRef(n._x,n._y,n._z,0,i._x,i._y,i._z,0,t._x,t._y,t._z,0,0,0,0,1,s),s}static OrthoLH(t,i,s,n,o){let r=new e;return e.OrthoLHToRef(t,i,s,n,r,o),r}static OrthoLHToRef(t,i,s,n,o,r){let a=s,c=n,h=2/t,_=2/i,y=2/(c-a),x=-(c+a)/(c-a);return e.FromValuesToRef(h,0,0,0,0,_,0,0,0,0,y,0,0,0,x,1,o),r&&o.multiplyToRef(v,o),o._updateIdentityStatus(h===1&&_===1&&y===1&&x===0),o}static OrthoOffCenterLH(t,i,s,n,o,r,a){let c=new e;return e.OrthoOffCenterLHToRef(t,i,s,n,o,r,c,a),c}static OrthoOffCenterLHToRef(t,i,s,n,o,r,a,c){let h=o,_=r,y=2/(i-t),x=2/(n-s),z=2/(_-h),R=-(_+h)/(_-h),T=(t+i)/(t-i),F=(n+s)/(s-n);return e.FromValuesToRef(y,0,0,0,0,x,0,0,0,0,z,0,T,F,R,1,a),c&&a.multiplyToRef(v,a),a.markAsUpdated(),a}static ObliqueOffCenterLHToRef(t,i,s,n,o,r,a,c,h,_,y){let x=-a*Math.cos(c),z=-a*Math.sin(c);return e.TranslationToRef(0,0,-h,m.Matrix[1]),e.FromValuesToRef(1,0,0,0,0,1,0,0,x,z,1,0,0,0,0,1,m.Matrix[0]),m.Matrix[1].multiplyToRef(m.Matrix[0],m.Matrix[0]),e.TranslationToRef(0,0,h,m.Matrix[1]),m.Matrix[0].multiplyToRef(m.Matrix[1],m.Matrix[0]),e.OrthoOffCenterLHToRef(t,i,s,n,o,r,_,y),m.Matrix[0].multiplyToRef(_,_),_}static OrthoOffCenterRH(t,i,s,n,o,r,a){let c=new e;return e.OrthoOffCenterRHToRef(t,i,s,n,o,r,c,a),c}static OrthoOffCenterRHToRef(t,i,s,n,o,r,a,c){return e.OrthoOffCenterLHToRef(t,i,s,n,o,r,a,c),a._m[10]*=-1,a}static ObliqueOffCenterRHToRef(t,i,s,n,o,r,a,c,h,_,y){let x=a*Math.cos(c),z=a*Math.sin(c);return e.TranslationToRef(0,0,h,m.Matrix[1]),e.FromValuesToRef(1,0,0,0,0,1,0,0,x,z,1,0,0,0,0,1,m.Matrix[0]),m.Matrix[1].multiplyToRef(m.Matrix[0],m.Matrix[0]),e.TranslationToRef(0,0,-h,m.Matrix[1]),m.Matrix[0].multiplyToRef(m.Matrix[1],m.Matrix[0]),e.OrthoOffCenterRHToRef(t,i,s,n,o,r,_,y),m.Matrix[0].multiplyToRef(_,_),_}static PerspectiveLH(t,i,s,n,o,r=0){let a=new e,c=s,h=n,_=2*c/t,y=2*c/i,x=(h+c)/(h-c),z=-2*h*c/(h-c),R=Math.tan(r);return e.FromValuesToRef(_,0,0,0,0,y,0,R,0,0,x,1,0,0,z,0,a),o&&a.multiplyToRef(v,a),a._updateIdentityStatus(!1),a}static PerspectiveFovLH(t,i,s,n,o,r=0,a=!1){let c=new e;return e.PerspectiveFovLHToRef(t,i,s,n,c,!0,o,r,a),c}static PerspectiveFovLHToRef(t,i,s,n,o,r=!0,a,c=0,h=!1){let _=s,y=n,x=1/Math.tan(t*.5),z=r?x/i:x,R=r?x:x*i,T=h&&_===0?-1:y!==0?(y+_)/(y-_):1,F=h&&_===0?2*y:y!==0?-2*y*_/(y-_):-2*_,u=Math.tan(c);return e.FromValuesToRef(z,0,0,0,0,R,0,u,0,0,T,1,0,0,F,0,o),a&&o.multiplyToRef(v,o),o._updateIdentityStatus(!1),o}static PerspectiveFovReverseLHToRef(t,i,s,n,o,r=!0,a,c=0){let h=1/Math.tan(t*.5),_=r?h/i:h,y=r?h:h*i,x=Math.tan(c);return e.FromValuesToRef(_,0,0,0,0,y,0,x,0,0,-s,1,0,0,1,0,o),a&&o.multiplyToRef(v,o),o._updateIdentityStatus(!1),o}static PerspectiveFovRH(t,i,s,n,o,r=0,a=!1){let c=new e;return e.PerspectiveFovRHToRef(t,i,s,n,c,!0,o,r,a),c}static PerspectiveFovRHToRef(t,i,s,n,o,r=!0,a,c=0,h=!1){let _=s,y=n,x=1/Math.tan(t*.5),z=r?x/i:x,R=r?x:x*i,T=h&&_===0?1:y!==0?-(y+_)/(y-_):-1,F=h&&_===0?2*y:y!==0?-2*y*_/(y-_):-2*_,u=Math.tan(c);return e.FromValuesToRef(z,0,0,0,0,R,0,u,0,0,T,-1,0,0,F,0,o),a&&o.multiplyToRef(v,o),o._updateIdentityStatus(!1),o}static PerspectiveFovReverseRHToRef(t,i,s,n,o,r=!0,a,c=0){let h=1/Math.tan(t*.5),_=r?h/i:h,y=r?h:h*i,x=Math.tan(c);return e.FromValuesToRef(_,0,0,0,0,y,0,x,0,0,-s,-1,0,0,-1,0,o),a&&o.multiplyToRef(v,o),o._updateIdentityStatus(!1),o}static GetFinalMatrix(t,i,s,n,o,r){let a=t.width,c=t.height,h=t.x,_=t.y,y=e.FromValues(a/2,0,0,0,0,-c/2,0,0,0,0,r-o,0,h+a/2,c/2+_,o,1),x=new e;return i.multiplyToRef(s,x),x.multiplyToRef(n,x),x.multiplyToRef(y,x)}static GetAsMatrix2x2(t){let i=t.m,s=[i[0],i[1],i[4],i[5]];return K.MatrixUse64Bits?s:new Float32Array(s)}static GetAsMatrix3x3(t){let i=t.m,s=[i[0],i[1],i[2],i[4],i[5],i[6],i[8],i[9],i[10]];return K.MatrixUse64Bits?s:new Float32Array(s)}static Transpose(t){let i=new e;return e.TransposeToRef(t,i),i}static TransposeToRef(t,i){let s=t.m,n=s[0],o=s[4],r=s[8],a=s[12],c=s[1],h=s[5],_=s[9],y=s[13],x=s[2],z=s[6],R=s[10],T=s[14],F=s[3],u=s[7],f=s[11],A=s[15],w=i._m;return w[0]=n,w[1]=o,w[2]=r,w[3]=a,w[4]=c,w[5]=h,w[6]=_,w[7]=y,w[8]=x,w[9]=z,w[10]=R,w[11]=T,w[12]=F,w[13]=u,w[14]=f,w[15]=A,i.markAsUpdated(),i._updateIdentityStatus(t._isIdentity,t._isIdentityDirty),i}static Reflection(t){let i=new e;return e.ReflectionToRef(t,i),i}static ReflectionToRef(t,i){t.normalize();let s=t.normal.x,n=t.normal.y,o=t.normal.z,r=-2*s,a=-2*n,c=-2*o;return e.FromValuesToRef(r*s+1,a*s,c*s,0,r*n,a*n+1,c*n,0,r*o,a*o,c*o+1,0,r*t.d,a*t.d,c*t.d,1,i),i}static FromXYZAxesToRef(t,i,s,n){return e.FromValuesToRef(t._x,t._y,t._z,0,i._x,i._y,i._z,0,s._x,s._y,s._z,0,0,0,0,1,n),n}static FromQuaternionToRef(t,i){let s=t._x*t._x,n=t._y*t._y,o=t._z*t._z,r=t._x*t._y,a=t._z*t._w,c=t._z*t._x,h=t._y*t._w,_=t._y*t._z,y=t._x*t._w;return i._m[0]=1-2*(n+o),i._m[1]=2*(r+a),i._m[2]=2*(c-h),i._m[3]=0,i._m[4]=2*(r-a),i._m[5]=1-2*(o+s),i._m[6]=2*(_+y),i._m[7]=0,i._m[8]=2*(c+h),i._m[9]=2*(_-y),i._m[10]=1-2*(n+s),i._m[11]=0,i._m[12]=0,i._m[13]=0,i._m[14]=0,i._m[15]=1,i.markAsUpdated(),i}};O._UpdateFlagSeed=0;O._IdentityReadOnly=O.Identity();Object.defineProperties(O.prototype,{dimension:{value:[4,4]},rank:{value:2}});m=class{};m.Vector3=G(11,d.Zero);m.Matrix=G(2,O.Identity);m.Quaternion=G(3,S.Zero);U=class{};U.Vector2=G(3,X.Zero);U.Vector3=G(13,d.Zero);U.Vector4=G(3,Q.Zero);U.Quaternion=G(3,S.Zero);U.Matrix=G(8,O.Identity);it("BABYLON.Vector2",X);it("BABYLON.Vector3",d);it("BABYLON.Vector4",Q);it("BABYLON.Matrix",O);v=O.FromValues(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1)});export{Lt as a,kt as b,Ot as c,b as d,ht as e,At as f,Ht as g,_t as h,X as i,d as j,Q as k,S as l,O as m,U as n,Ct as o};
